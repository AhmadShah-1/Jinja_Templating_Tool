/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={46830:function(e,t,n){e.exports=n.p+"assets/PVEDI.png"},58394:function(e,t,n){e.exports=n.p+"2ef5348c1c39f0fbc1de.css"},60947:function(e,t,n){e.exports=n.p+"97b3f2274b5b30595e02.js"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,n(o.key),o)}}function n(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}var r;function o(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function c(n,r,o,i){var c=r&&r.prototype instanceof l?r:l,u=Object.create(c.prototype);return a(u,"_invoke",function(n,r,o){var a,i,c,l=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return a=t,i=0,c=e,p.n=n,s}};function f(n,r){for(i=n,c=r,t=0;!d&&l&&!o&&t<u.length;t++){var o,a=u[t],f=p.p,m=a[2];n>3?(o=m===r)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=f&&((o=n<2&&f<a[1])?(i=0,p.v=r,p.n=a[1]):f<m&&(o=n<3||a[0]>r||r>m)&&(a[4]=n,a[5]=r,p.n=m,i=0))}if(o||n>1)return s;throw d=!0,r}return function(o,u,m){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&f(u,m),i=u,c=m;(t=i<2?e:c)||!d;){a||(i?i<3?(i>1&&(p.n=-1),f(i,c)):p.n=c:p.v=c);try{if(l=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(d=p.n<0)?c:n.call(r,p))!==s)break}catch(t){a=e,i=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,o,i),!0),u}var s={};function l(){}function u(){}function d(){}t=Object.getPrototypeOf;var p=[][r]?t(t([][r]())):(a(t={},r,function(){return this}),t),f=d.prototype=l.prototype=Object.create(p);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,a(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=d,a(f,"constructor",d),a(d,"constructor",u),u.displayName="GeneratorFunction",a(d,i,"GeneratorFunction"),a(f),a(f,i,"Generator"),a(f,r,function(){return this}),a(f,"toString",function(){return"[object Generator]"}),(o=function(){return{w:c,m:m}})()}function a(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}a=function(e,t,n,r){function i(t,n){a(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},a(e,t,n,r)}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){c(a,r,o,i,s,"next",e)}function s(e){c(a,r,o,i,s,"throw",e)}i(void 0)})}}var l="variables",u=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.variables=[],this.currentBlock={type:null},this.container=null,this.variableContainer=null},n=[{key:"init",value:function(e,t){this.container=document.getElementById(e),this.variableContainer=document.getElementById(t),this.renderEmptyState()}},{key:"updateVariables",value:function(e){this.variables=e,this.renderVariableList()}},{key:"renderVariableList",value:function(){var e=this;this.variableContainer&&(this.variableContainer.innerHTML="",0!==this.variables.length?this.variables.forEach(function(t){var n=document.createElement("div");n.className="bg-white border border-gray-200 rounded px-2 py-1 text-xs cursor-grab hover:border-blue-400 mb-1 shadow-sm select-none",n.innerText=t,n.draggable=!0,n.addEventListener("dragstart",function(e){e.dataTransfer.setData("text/plain",t),e.dataTransfer.effectAllowed="copy"}),e.variableContainer.appendChild(n)}):this.variableContainer.innerHTML='<div class="text-gray-400 italic text-xs p-2">No variables found</div>')}},{key:"renderEmptyState",value:function(){var e=this;this.container.innerHTML='\n            <div class="flex flex-col items-center justify-center h-full text-gray-500 space-y-4 mt-8">\n                <p class="text-xs italic">Select a block type to start</p>\n                <div class="flex flex-wrap gap-2 justify-center">\n                    <button id="btn-start-if" class="bg-blue-50 text-blue-600 border border-blue-200 px-3 py-1.5 rounded text-xs hover:bg-blue-100 font-medium">If Statement</button>\n                    <button id="btn-start-for" class="bg-green-50 text-green-600 border border-green-200 px-3 py-1.5 rounded text-xs hover:bg-green-100 font-medium">For Loop</button>\n                    <button id="btn-start-filter" class="bg-purple-50 text-purple-600 border border-purple-200 px-3 py-1.5 rounded text-xs hover:bg-purple-100 font-medium">Filter</button>\n                </div>\n            </div>\n        ',document.getElementById("btn-start-if").onclick=function(){return e.startIf()},document.getElementById("btn-start-for").onclick=function(){return e.startFor()},document.getElementById("btn-start-filter").onclick=function(){return e.startFilter()}}},{key:"startIf",value:function(){this.currentBlock={type:"if",conditions:[{left:"",op:"==",right:"",content:""}],elseContent:"",hasElse:!1},this.renderIfBuilder()}},{key:"startFor",value:function(){this.currentBlock={type:"for",iterator:"item",iterable:"",content:""},this.renderForBuilder()}},{key:"startFilter",value:function(){this.currentBlock={type:"filter",variable:"",filter:"upper",customFilter:""},this.renderFilterBuilder()}},{key:"renderIfBuilder",value:function(){var e=this;this.container.innerHTML="";var t=document.createElement("div");t.className="space-y-2";var n=document.createElement("div");n.className="flex justify-between items-center mb-4",n.innerHTML='<span class="font-bold text-xs text-gray-700">IF Statement</span>';var r=document.createElement("button");if(r.innerText="Reset",r.className="text-xs text-red-500 hover:underline",r.onclick=function(){return e.renderEmptyState()},n.appendChild(r),t.appendChild(n),this.currentBlock.conditions.forEach(function(n,r){var o=document.createElement("div");o.className="bg-gray-50 p-2 rounded border border-gray-200 space-y-2 relative group";var a=document.createElement("div");if(a.className="text-[10px] font-mono font-bold text-blue-600 uppercase",a.innerText=0===r?"IF":"ELIF",r>0){var i=document.createElement("button");i.innerHTML="&times;",i.className="absolute top-1 right-2 text-gray-400 hover:text-red-500 text-lg leading-3",i.onclick=function(){e.currentBlock.conditions.splice(r,1),e.renderIfBuilder()},o.appendChild(i)}var c=document.createElement("div");c.className="flex gap-1 items-center";var s=e.createDroppableInput(n.left,function(e){return n.left=e}),l=document.createElement("select");l.className="border border-gray-300 rounded text-xs py-1 px-0.5 bg-white",["==","!=",">",">=","<","<=","in","not in"].forEach(function(e){var t=document.createElement("option");t.value=e,t.innerText=e,e===n.op&&(t.selected=!0),l.appendChild(t)}),l.onchange=function(e){return n.op=e.target.value};var u=e.createDroppableInput(n.right,function(e){return n.right=e});c.appendChild(s),c.appendChild(l),c.appendChild(u);var d=document.createElement("div");d.className="mt-1 pt-1 border-t border-gray-200 border-dashed";var p=document.createElement("input");p.className="w-full border border-gray-300 rounded px-1.5 py-1 text-xs focus:ring-1 focus:ring-blue-500 outline-none transition-colors bg-white",p.placeholder="Then output this text...",p.value=n.content||"",p.oninput=function(e){return n.content=e.target.value},d.appendChild(p),o.appendChild(a),o.appendChild(c),o.appendChild(d),t.appendChild(o)}),this.currentBlock.hasElse){var o=document.createElement("div");o.className="bg-gray-50 p-2 rounded border border-gray-200 relative space-y-2",o.innerHTML='<span class="text-[10px] font-mono font-bold text-blue-600 uppercase">ELSE</span>';var a=document.createElement("button");a.innerHTML="&times;",a.className="absolute top-1 right-2 text-gray-400 hover:text-red-500 text-lg leading-3",a.onclick=function(){e.currentBlock.hasElse=!1,e.currentBlock.elseContent="",e.renderIfBuilder()};var i=document.createElement("input");i.className="w-full border border-gray-300 rounded px-1.5 py-1 text-xs focus:ring-1 focus:ring-blue-500 outline-none transition-colors bg-white",i.placeholder="Otherwise output this text...",i.value=this.currentBlock.elseContent||"",i.oninput=function(t){return e.currentBlock.elseContent=t.target.value},o.appendChild(a),o.appendChild(i),t.appendChild(o)}var c=document.createElement("div");c.className="flex gap-2 mt-2";var s=document.createElement("button");s.className="flex-1 bg-blue-50 text-blue-600 border border-blue-200 rounded py-1 text-lg font-bold hover:bg-blue-100",s.innerText="+",s.title="Add ELIF",s.onclick=function(){e.currentBlock.conditions.push({left:"",op:"==",right:"",content:""}),e.renderIfBuilder()};var l=document.createElement("button");l.className="flex-1 bg-gray-100 text-gray-600 border border-gray-300 rounded py-1 text-lg font-bold hover:bg-gray-200 disabled:opacity-50",l.innerText="-",l.title="Add ELSE",l.disabled=this.currentBlock.hasElse,l.onclick=function(){e.currentBlock.hasElse=!0,e.renderIfBuilder()},c.appendChild(s),c.appendChild(l),t.appendChild(c),this.container.appendChild(t)}},{key:"renderForBuilder",value:function(){var e=this;this.container.innerHTML="";var t=document.createElement("div");t.className="space-y-2";var n=document.createElement("div");n.className="flex justify-between items-center mb-4",n.innerHTML='<span class="font-bold text-xs text-gray-700">FOR Loop</span>';var r=document.createElement("button");r.innerText="Reset",r.className="text-xs text-red-500 hover:underline",r.onclick=function(){return e.renderEmptyState()},n.appendChild(r),t.appendChild(n);var o=document.createElement("div");o.className="bg-gray-50 p-2 rounded border border-gray-200 space-y-2";var a=document.createElement("div");a.className="text-[10px] font-mono font-bold text-green-600 uppercase",a.innerText="FOR";var i=document.createElement("div");i.className="flex gap-1 items-center text-xs";var c=document.createElement("input");c.className="w-1/3 border border-gray-300 rounded px-1 py-1",c.placeholder="item",c.value=this.currentBlock.iterator,c.oninput=function(t){return e.currentBlock.iterator=t.target.value};var s=document.createElement("span");s.innerText="in",s.className="font-bold text-gray-500";var l=this.createDroppableInput(this.currentBlock.iterable,function(t){return e.currentBlock.iterable=t});l.classList.remove("w-full"),l.classList.add("flex-1"),i.appendChild(c),i.appendChild(s),i.appendChild(l);var u=document.createElement("div");u.className="mt-1 pt-1 border-t border-gray-200 border-dashed";var d=document.createElement("input");d.className="w-full border border-gray-300 rounded px-1.5 py-1 text-xs focus:ring-1 focus:ring-blue-500 outline-none transition-colors bg-white",d.placeholder="Repeat this text...",d.value=this.currentBlock.content||"",d.oninput=function(t){return e.currentBlock.content=t.target.value},u.appendChild(d),o.appendChild(a),o.appendChild(i),o.appendChild(u),t.appendChild(o),this.container.appendChild(t)}},{key:"renderFilterBuilder",value:function(){var e=this;this.container.innerHTML="";var t=document.createElement("div");t.className="space-y-2";var n=document.createElement("div");n.className="flex justify-between items-center mb-4",n.innerHTML='<span class="font-bold text-xs text-gray-700">Filter Variable</span>';var r=document.createElement("button");r.innerText="Reset",r.className="text-xs text-red-500 hover:underline",r.onclick=function(){return e.renderEmptyState()},n.appendChild(r),t.appendChild(n);var o=document.createElement("div");o.className="bg-gray-50 p-2 rounded border border-gray-200 space-y-3";var a=document.createElement("div");a.className="space-y-1",a.innerHTML='<label class="text-[10px] font-bold text-gray-500 uppercase block">Variable</label>';var i=this.createDroppableInput(this.currentBlock.variable,function(t){return e.currentBlock.variable=t});a.appendChild(i);var c=document.createElement("div");c.className="space-y-1",c.innerHTML='<label class="text-[10px] font-bold text-gray-500 uppercase block">Filter</label>';var s=document.createElement("select");s.className="w-full border border-gray-300 rounded px-1.5 py-1 text-xs bg-white focus:ring-1 focus:ring-purple-500 outline-none",["upper","lower","title","capitalize","trim","length","round","abs","first","last","safe","custom"].forEach(function(t){var n=document.createElement("option");n.value=t,n.innerText=t,t===e.currentBlock.filter&&(n.selected=!0),s.appendChild(n)});var l=document.createElement("input");l.className="w-full border border-gray-300 rounded px-1.5 py-1 text-xs bg-white focus:ring-1 focus:ring-purple-500 outline-none mt-1 hidden",l.placeholder="Enter custom filter name",l.value=this.currentBlock.customFilter||"","custom"===this.currentBlock.filter&&l.classList.remove("hidden"),l.oninput=function(t){return e.currentBlock.customFilter=t.target.value},s.onchange=function(t){e.currentBlock.filter=t.target.value,"custom"===t.target.value?(l.classList.remove("hidden"),l.focus()):l.classList.add("hidden")},c.appendChild(s),c.appendChild(l),o.appendChild(a),o.appendChild(c),t.appendChild(o),this.container.appendChild(t)}},{key:"createDroppableInput",value:function(e,t){var n=document.createElement("input");return n.type="text",n.className="w-full border border-gray-300 rounded px-1.5 py-1 text-xs focus:ring-1 focus:ring-blue-500 outline-none transition-colors",n.value=e||"",n.placeholder="Value / Drag Var",n.oninput=function(e){return t(e.target.value)},n.ondragover=function(e){e.preventDefault(),n.classList.add("border-blue-500","bg-blue-50")},n.ondragleave=function(){n.classList.remove("border-blue-500","bg-blue-50")},n.ondrop=function(e){e.preventDefault(),n.classList.remove("border-blue-500","bg-blue-50");var r=e.dataTransfer.getData("text/plain");if(r){var o=n.selectionStart,a=n.selectionEnd,i=n.value,c=i.substring(0,o)+r+i.substring(a);n.value=c,t(c),n.focus()}},n}},{key:"generateJinja",value:function(){if(!this.currentBlock.type)return"";if("if"===this.currentBlock.type){var e="";if(this.currentBlock.conditions.forEach(function(t,n){var r=0===n?"if":"elif",o=t.left||"var",a=t.right||"value",i=t.content?" ".concat(t.content):"";e+="{% ".concat(r," ").concat(o," ").concat(t.op," ").concat(a," %}").concat(i)}),this.currentBlock.hasElse){var t=this.currentBlock.elseContent?" ".concat(this.currentBlock.elseContent):"";e+="{% else %}".concat(t)}return e+="{% endif %}"}if("for"===this.currentBlock.type){var n=this.currentBlock.iterator||"item",r=this.currentBlock.iterable||"items",o=this.currentBlock.content?" ".concat(this.currentBlock.content):"";return"{% for ".concat(n," in ").concat(r," %}").concat(o,"{% endfor %}")}if("filter"===this.currentBlock.type){var a=this.currentBlock.variable||"var",i=this.currentBlock.filter||"upper";return"custom"===i&&(i=this.currentBlock.customFilter||"custom_filter"),"{{ ".concat(a," | ").concat(i," }}")}return""}}],n&&t(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}());function d(e,t){console.error("[Stanza Add-in] ".concat(e),t);var n=document.getElementById("console-output");if(n){var r=document.createElement("div");r.className="text-red-400",r.textContent="ERROR: ".concat(e).concat(t?" - "+t.message:""),n.appendChild(r),n.scrollTop=n.scrollHeight}}function p(e){console.log("[Stanza Add-in] ".concat(e));var t=document.getElementById("console-output");if(t){var n=document.createElement("div");n.className="text-gray-300",n.textContent=e,t.appendChild(n),t.scrollTop=t.scrollHeight}}if("undefined"==typeof Office){d("Office.js is not loaded. Make sure the add-in is properly sideloaded.");var f=document.getElementById("sideload-msg");f&&(f.classList.remove("hidden"),f.innerHTML='\n      <div>\n        <h2 class="text-xl text-gray-600 mb-4">Please sideload your add-in.</h2>\n        <p class="text-sm text-gray-500 mb-2">Office.js failed to load.</p>\n        <p class="text-xs text-gray-400">Check the browser console (F12) for more details.</p>\n      </div>\n    ')}else p("Office.js loaded, initializing..."),Office.onReady(function(e){if(p("Office.onReady called. Host: ".concat(e.host,", Platform: ").concat(e.platform)),e.host===Office.HostType.Word){p("Word host detected, initializing add-in...");try{var t=document.getElementById("sideload-msg");t&&(t.style.display="none");try{u.init("builder-canvas","builder-vars"),p("Logic Builder initialized")}catch(e){d("Failed to initialize Logic Builder",e)}try{var n=document.getElementById("action-btn"),r=document.getElementById("refresh-btn"),o=document.getElementById("tab-variables"),a=document.getElementById("tab-logic"),i=document.getElementById("tab-builder");n&&(n.onclick=function(){return function(){return g.apply(this,arguments)}()}),r&&(r.onclick=function(){return S(b)}),o&&(o.onclick=function(){return h("variables")}),a&&(a.onclick=function(){return h("logic")}),i&&(i.onclick=function(){return h("builder")}),p("Event listeners attached")}catch(e){d("Failed to attach event listeners",e)}S(b),m(),p("Add-in initialized successfully")}catch(e){d("Error during initialization",e)}}else{d("Unsupported host: ".concat(e.host,". This add-in only works with Word."));var c=document.getElementById("sideload-msg");c&&(c.classList.remove("hidden"),c.innerHTML='\n          <div>\n            <h2 class="text-xl text-gray-600 mb-4">Unsupported Host</h2>\n            <p class="text-sm text-gray-500">This add-in only works with Microsoft Word.</p>\n            <p class="text-xs text-gray-400 mt-2">Current host: '.concat(e.host,"</p>\n          </div>\n        "))}}).catch(function(e){d("Office.onReady failed",e);var t=document.getElementById("sideload-msg");t&&(t.classList.remove("hidden"),t.innerHTML='\n        <div>\n          <h2 class="text-xl text-red-600 mb-4">Initialization Failed</h2>\n          <p class="text-sm text-gray-500 mb-2">'.concat(e.message||"Unknown error",'</p>\n          <p class="text-xs text-gray-400">Check the browser console (F12) for more details.</p>\n        </div>\n      '))});function m(){r&&clearInterval(r),r=setInterval(function(){S(b)},5e3)}function h(e){l=e;var t={variables:document.getElementById("tab-variables"),logic:document.getElementById("tab-logic"),builder:document.getElementById("tab-builder")},n={variables:document.getElementById("section-variables"),logic:document.getElementById("section-logic"),builder:document.getElementById("section-builder")};Object.values(t).forEach(function(e){e.classList.remove("border-blue-600","text-blue-600"),e.classList.add("border-transparent","text-gray-500");var t=e.querySelector("span");t&&(t.classList.remove("bg-blue-100","text-blue-700"),t.classList.add("bg-gray-100","text-gray-600"))}),Object.values(n).forEach(function(e){return e.classList.add("hidden")});var r=t[e];r.classList.remove("border-transparent","text-gray-500"),r.classList.add("border-blue-600","text-blue-600");var o,a,i,c=r.querySelector("span");c&&(c.classList.remove("bg-gray-100","text-gray-600"),c.classList.add("bg-blue-100","text-blue-700")),n[e].classList.remove("hidden"),o=document.getElementById("action-btn-text"),a=document.getElementById("icon-convert"),i=document.getElementById("icon-insert"),"builder"===l?(o.innerText="Insert Logic",a.classList.add("hidden"),i.classList.remove("hidden")):(o.innerText="Convert Selection",a.classList.remove("hidden"),i.classList.add("hidden"))}function g(){return(g=s(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:if("builder"!==l){e.n=2;break}return e.n=1,S(E);case 1:e.n=3;break;case 2:return e.n=3,S(y);case 3:return e.a(2)}},e)}))).apply(this,arguments)}function b(){return v.apply(this,arguments)}function v(){return v=s(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Word.run(function(){var e=s(o().m(function e(t){var n,r,a,i,c,s,l;return o().w(function(e){for(;;)switch(e.n){case 0:return(n=t.document.body).load("text"),e.n=1,t.sync();case 1:r=n.text,a=C(r),i=a.variables,c=a.logicBlocks,s=a.errors,l=a.variableCounts,L(i,l),I(c),T(s),u.updateVariables(i);case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}},e)})),v.apply(this,arguments)}function y(){return x.apply(this,arguments)}function x(){return x=s(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Word.run(function(){var e=s(o().m(function e(t){var n,r,a,i;return o().w(function(e){for(;;)switch(e.n){case 0:return(n=t.document.getSelection()).load("text"),e.n=1,t.sync();case 1:if(r=n.text.trim()){e.n=2;break}return e.a(2);case 2:return a=r.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,""),i="{{ ".concat(a," }}"),n.insertText(i,Word.InsertLocation.replace),e.n=3,t.sync();case 3:return e.n=4,b();case 4:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}},e)})),x.apply(this,arguments)}function E(){return w.apply(this,arguments)}function w(){return w=s(o().m(function e(){var t;return o().w(function(e){for(;;)switch(e.n){case 0:if(t=u.generateJinja()){e.n=1;break}return e.a(2);case 1:return e.n=2,Word.run(function(){var e=s(o().m(function e(n){return o().w(function(e){for(;;)switch(e.n){case 0:return n.document.getSelection().insertText(t,Word.InsertLocation.replace),e.n=1,n.sync();case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 2:return e.n=3,b();case 3:return e.a(2)}},e)})),w.apply(this,arguments)}function k(e,t){return B.apply(this,arguments)}function B(){return B=s(o().m(function e(t,n){return o().w(function(e){for(;;)switch(e.n){case 0:if(n&&t!==n){e.n=1;break}return e.a(2);case 1:if(n.match(/^[a-zA-Z0-9_]+$/)){e.n=2;break}throw new Error("Invalid variable name. Only letters, numbers, and underscores are allowed.");case 2:return r&&clearInterval(r),e.n=3,Word.run(function(){var e=s(o().m(function e(r){var a,i,c,s,l,u,p,f;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,a=r.document.body,i="{{ ".concat(t," }}"),c=a.search(i,{matchCase:!0}),r.load(c,"text"),e.n=1,r.sync();case 1:for(s=c.items.length-1;s>=0;s--)c.items[s].insertText("{{ ".concat(n," }}"),Word.InsertLocation.replace);return e.n=2,r.sync();case 2:return l="{{".concat(t,"}}"),u=a.search(l,{matchCase:!0}),r.load(u,"text"),e.n=3,r.sync();case 3:for(p=u.items.length-1;p>=0;p--)u.items[p].insertText("{{ ".concat(n," }}"),Word.InsertLocation.replace);return e.n=4,r.sync();case 4:e.n=6;break;case 5:throw e.p=5,d("Error in renameVariable",f=e.v),f;case 6:return e.a(2)}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}());case 3:return m(),e.n=4,b();case 4:return e.a(2)}},e)})),B.apply(this,arguments)}function C(e){for(var t,n=new Set,r=[],o=new Map,a=[],c=[],s=[],l=/\{\{\s*([a-zA-Z0-9_]+)\s*\}\}/g;null!==(t=l.exec(e));){var u=t[0],d=t[1];u.includes("  ")&&r.push({type:"warning",message:"Extra whitespace in '".concat(u,"'"),index:t.index,length:u.length,snippet:u}),n.add(d),o.set(d,(o.get(d)||0)+1)}for(var p,f=/\{%\s*(.+?)\s*%\}/g;null!==(p=f.exec(e));){var m=p[1].trim(),h="unknown",g=m,b=p[0],v=p.index;m.startsWith("if ")?(h="if",g=m.substring(3),c.push({type:"if",index:v,content:b})):m.startsWith("elif ")?(h="elif",g=m.substring(5),0===c.length&&r.push({type:"error",message:"Unexpected '{% elif ... %}' without 'if'",index:v,length:b.length,snippet:b})):m.startsWith("else")?(h="else",g="(fallback)",0===c.length&&0===s.length&&r.push({type:"error",message:"Unexpected '{% else %}'",index:v,length:b.length,snippet:b})):m.startsWith("endif")?(h="endif",g="",0===c.length?r.push({type:"error",message:"Unexpected '{% endif %}' without 'if'",index:v,length:b.length,snippet:b}):c.pop()):m.startsWith("for ")?(h="for",g=m.substring(4),s.push({type:"for",index:v,content:b})):m.startsWith("endfor")&&(h="endfor",g="",0===s.length?r.push({type:"error",message:"Unexpected '{% endfor %}' without 'for'",index:v,length:b.length,snippet:b}):s.pop()),a.push({type:h,content:m,summary:g,fullMatch:p[0]})}if(c.length>0){var y=c[c.length-1];r.push({type:"error",message:"Unclosed 'if' statement",index:y.index,length:y.content.length,snippet:y.content})}if(s.length>0){var x=s[s.length-1];r.push({type:"error",message:"Unclosed 'for' loop",index:x.index,length:x.content.length,snippet:x.content})}for(var E=/(?<!\{)\{\s*([a-zA-Z0-9_]+)\s*\}\}/g;null!==(t=E.exec(e));)r.push({type:"error",message:"Malformed opening brace: '{ ".concat(t[1]," }}'"),index:t.index,length:t[0].length,snippet:t[0]});for(var w=/\{\{\s*([a-zA-Z0-9_]+)\s*\}(?!\})/g;null!==(t=w.exec(e));)r.push({type:"error",message:"Malformed closing brace: '{{ ".concat(t[1]," }'"),index:t.index,length:t[0].length,snippet:t[0]});var k;return(k=e.matchAll(/\{\{/g),function(e){if(Array.isArray(e))return i(e)}(k)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(k)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(k)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).forEach(function(t){var n=t.index,o=e.slice(n,n+50);o.includes("}}")||o.match(/\{\{\s*[a-zA-Z0-9_]+\s*\}\}/)||(o.includes("\n")||o.length<50)&&r.push({type:"error",message:"Unclosed variable",index:n,length:2,snippet:"{{"})}),[{regex:/\{\{\s*\]/g,msg:"Syntax Error: '{{ ]'"},{regex:/\{\[\s*\}\}/g,msg:"Syntax Error: '{[ }}'"},{regex:/\{\[\s*\}/g,msg:"Syntax Error: '{[ }'"},{regex:/\[\[/g,msg:"Double brackets '[[' detected (use '{{')"},{regex:/\]\]/g,msg:"Double brackets ']]' detected (use '}}')"},{regex:/\{\{\s*\}\}/g,msg:"Empty variable '{{ }}'"},{regex:/(?<!\{)\{\s*[a-zA-Z0-9_]+\s*\}(?!\})/g,msg:"Single braces used '{ var }' (use '{{ var }}')"}].forEach(function(t){for(var n;null!==(n=t.regex.exec(e));)r.push({type:"error",message:"".concat(t.msg," found."),index:n.index,length:n[0].length,snippet:n[0]})}),{variables:Array.from(n).sort(),variableCounts:o,logicBlocks:a,errors:r}}function L(e,t){if(!document.activeElement||"INPUT"!==document.activeElement.tagName){var n=document.getElementById("variable-list");document.getElementById("var-count").innerText=e.length,n.innerHTML="",0!==e.length?e.forEach(function(e,r){var o=t.get(e)||0,a=r,i=document.createElement("div");i.className="group flex flex-col bg-white p-2 rounded border border-gray-200 hover:border-blue-400 transition-all shadow-sm mb-2",i.innerHTML='\n      <div class="flex items-center justify-between w-full" id="view-'.concat(a,'">\n        <div class="flex items-center gap-2 overflow-hidden">\n            <div class="flex items-center gap-1 text-gray-500 text-xs min-w-[24px]">\n                <span class="bg-gray-100 px-1.5 py-0.5 rounded-full font-mono" title="Occurrences">').concat(o,'</span>\n            </div>\n            <span class="text-blue-600 bg-blue-50 p-0.5 rounded text-[10px] font-mono">{{</span>\n            <span class="font-medium text-gray-700 truncate cursor-pointer hover:text-blue-700" title="Click to rename" onclick="toggleEdit(\'').concat(a,"')\">").concat(e,'</span>\n            <span class="text-blue-600 bg-blue-50 p-0.5 rounded text-[10px] font-mono">}}</span>\n        </div>\n        <div class="flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity">\n             <button class="text-gray-400 hover:text-blue-600 p-1" title="Rename" onclick="toggleEdit(\'').concat(a,'\')">\n                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path></svg>\n            </button>\n            <button class="text-gray-400 hover:text-blue-600 p-1" title="Copy" onclick="navigator.clipboard.writeText(\'{{ ').concat(e,' }}\')">\n                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>\n            </button>\n        </div>\n      </div>\n      \n      <div class="hidden w-full mt-2 flex items-center gap-2" id="edit-').concat(a,'">\n        <input type="text" id="input-').concat(a,'" value="').concat(e,'" data-original="').concat(e,'" class="flex-1 border border-blue-300 rounded px-2 py-1 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500" />\n        <button class="bg-blue-600 text-white px-2 py-1 rounded text-xs hover:bg-blue-700" onclick="saveRename(\'').concat(a,'\')">Save</button>\n        <button class="text-gray-500 hover:text-gray-700 px-1" onclick="toggleEdit(\'').concat(a,"')\">✕</button>\n      </div>\n    "),n.appendChild(i)}):n.innerHTML='<div class="text-center py-8 text-gray-400 italic text-xs">No variables detected. Click Refresh to scan.</div>'}}function I(e){var t=document.getElementById("logic-list"),n=document.getElementById("logic-count"),r=e.filter(function(e){return!e.type.startsWith("end")&&!e.type.startsWith("elif")&&!e.type.startsWith("else")});n.innerText=r.length,t.innerHTML="",0!==e.length?e.forEach(function(e){var n=document.createElement("div"),r="",o="bg-gray-50 border-gray-200",a="text-gray-600";"if"===e.type?(r='<svg class="w-3 h-3 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>',o="bg-purple-50 border-purple-100",a="text-purple-800 font-medium"):"for"===e.type?(r='<svg class="w-3 h-3 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>',o="bg-green-50 border-green-100",a="text-green-800 font-medium"):e.type.startsWith("end")&&(o="bg-gray-50 border-transparent opacity-60",a="text-gray-400 font-mono text-[10px]"),n.className="flex items-center gap-2 p-1.5 rounded border ".concat(o," text-xs"),n.innerHTML="\n            ".concat(r,'\n            <span class="font-mono ').concat(e.type.startsWith("end")?"pl-4":""," ").concat(a,'">').concat(e.content,"</span>\n        "),t.appendChild(n)}):t.innerHTML='<div class="text-center py-4 text-gray-400 italic text-xs">No control logic detected.</div>'}function T(e){var t=document.getElementById("console-output"),n=document.getElementById("error-count");t.innerHTML="",e.length>0?(n.innerText=e.length,n.classList.remove("hidden"),e.forEach(function(e){var n=document.createElement("div"),r=void 0!==e.snippet,o=r?"cursor-pointer hover:bg-gray-800":"";"error"===e.type?(n.className="text-red-400 flex gap-2 items-start py-0.5 ".concat(o),n.innerHTML='<span class="text-red-500 font-bold text-xs mt-0.5">✖</span> <span>'.concat(e.message,"</span>")):(n.className="text-yellow-400 flex gap-2 items-start py-0.5 ".concat(o),n.innerHTML='<span class="text-yellow-500 font-bold text-xs mt-0.5">⚠</span> <span>'.concat(e.message,"</span>")),r&&(n.onclick=function(){return function(e){return N.apply(this,arguments)}(e.snippet)},n.title="Go to error location"),t.appendChild(n)})):(n.classList.add("hidden"),t.innerHTML='<div class="text-green-500 flex gap-2 items-center"><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> No errors found.</div>')}function N(){return N=s(o().m(function e(t){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Word.run(function(){var e=s(o().m(function e(n){var r,a;return o().w(function(e){for(;;)switch(e.n){case 0:return r=n.document.body,a=r.search(t,{matchCase:!0}),n.load(a,"items"),e.n=1,n.sync();case 1:if(!(a.items.length>0)){e.n=2;break}return a.items[0].select(),e.n=2,n.sync();case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}},e)})),N.apply(this,arguments)}function S(e){return M.apply(this,arguments)}function M(){return(M=s(o().m(function e(t){var n,r,a;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,t();case 1:e.n=3;break;case 2:e.p=2,a=e.v,console.error(a),n=document.getElementById("console-output"),(r=document.createElement("div")).className="text-red-400 break-words",r.innerText="System Error: ".concat(a.message),n.appendChild(r);case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}window.toggleEdit=function(e){var t=document.getElementById("view-".concat(e)),n=document.getElementById("edit-".concat(e));t&&n&&(n.classList.contains("hidden")?(t.classList.add("hidden"),n.classList.remove("hidden"),document.getElementById("input-".concat(e)).focus()):(t.classList.remove("hidden"),n.classList.add("hidden")))},window.saveRename=function(){var e=s(o().m(function e(t){var n,r,a;return o().w(function(e){for(;;)switch(e.n){case 0:if(!(n=document.getElementById("input-".concat(t)))){e.n=2;break}if(r=n.getAttribute("data-original"),(a=n.value.trim()).match(/^[a-zA-Z0-9_]+$/)){e.n=1;break}return console.error("Invalid variable name"),n.classList.add("border-red-500"),e.a(2);case 1:return toggleEdit(t),e.n=2,S(function(){return k(r,a)});case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()}(),new URL(n(58394),n.b),new URL(n(46830),n.b),new URL(n(60947),n.b)}();
//# sourceMappingURL=taskpane.js.map
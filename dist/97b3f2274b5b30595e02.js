/*! For license information please see 97b3f2274b5b30595e02.js.LICENSE.txt */
function _regenerator(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var s=r&&r.prototype instanceof c?r:c,l=Object.create(s.prototype);return _regeneratorDefine2(l,"_invoke",function(n,r,o){var a,c,s,l=0,u=o||[],d=!1,g={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,c=0,s=e,g.n=n,i}};function p(n,r){for(c=n,s=r,t=0;!d&&l&&!o&&t<u.length;t++){var o,a=u[t],p=g.p,f=a[2];n>3?(o=f===r)&&(s=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=n<2&&p<a[1])?(c=0,g.v=r,g.n=a[1]):p<f&&(o=n<3||a[0]>r||r>f)&&(a[4]=n,a[5]=r,g.n=f,c=0))}if(o||n>1)return i;throw d=!0,r}return function(o,u,f){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,f),c=u,s=f;(t=c<2?e:s)||!d;){a||(c?c<3?(c>1&&(g.n=-1),p(c,s)):g.n=s:g.v=s);try{if(l=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(d=g.n<0)?s:n.call(r,g))!==i)break}catch(t){a=e,c=1,s=t}finally{l=1}}return{value:t,done:d}}}(n,o,a),!0),l}var i={};function c(){}function s(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(_regeneratorDefine2(t={},r,function(){return this}),t),d=l.prototype=c.prototype=Object.create(u);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=l,_regeneratorDefine2(d,"constructor",l),_regeneratorDefine2(l,"constructor",s),s.displayName="GeneratorFunction",_regeneratorDefine2(l,o,"GeneratorFunction"),_regeneratorDefine2(d),_regeneratorDefine2(d,o,"Generator"),_regeneratorDefine2(d,r,function(){return this}),_regeneratorDefine2(d,"toString",function(){return"[object Generator]"}),(_regenerator=function(){return{w:a,m:g}})()}function _regeneratorDefine2(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}_regeneratorDefine2=function(e,t,n,r){function a(t,n){_regeneratorDefine2(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},_regeneratorDefine2(e,t,n,r)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function asyncGeneratorStep(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){asyncGeneratorStep(a,r,o,i,c,"next",e)}function c(e){asyncGeneratorStep(a,r,o,i,c,"throw",e)}i(void 0)})}}import{LogicBuilder}from"./logicbuilder";var autoRefreshInterval,currentTab="variables",logicBuilder=new LogicBuilder;function logError(e,t){console.error("[Stanza Add-in] ".concat(e),t);var n=document.getElementById("console-output");if(n){var r=document.createElement("div");r.className="text-red-400",r.textContent="ERROR: ".concat(e).concat(t?" - "+t.message:""),n.appendChild(r),n.scrollTop=n.scrollHeight}}function logInfo(e){console.log("[Stanza Add-in] ".concat(e));var t=document.getElementById("console-output");if(t){var n=document.createElement("div");n.className="text-gray-300",n.textContent=e,t.appendChild(n),t.scrollTop=t.scrollHeight}}if("undefined"==typeof Office){logError("Office.js is not loaded. Make sure the add-in is properly sideloaded.");var sideloadMsg=document.getElementById("sideload-msg");sideloadMsg&&(sideloadMsg.classList.remove("hidden"),sideloadMsg.innerHTML='\n      <div>\n        <h2 class="text-xl text-gray-600 mb-4">Please sideload your add-in.</h2>\n        <p class="text-sm text-gray-500 mb-2">Office.js failed to load.</p>\n        <p class="text-xs text-gray-400">Check the browser console (F12) for more details.</p>\n      </div>\n    ')}else logInfo("Office.js loaded, initializing..."),Office.onReady(function(e){if(logInfo("Office.onReady called. Host: ".concat(e.host,", Platform: ").concat(e.platform)),e.host===Office.HostType.Word){logInfo("Word host detected, initializing add-in...");try{var t=document.getElementById("sideload-msg");t&&(t.style.display="none");try{logicBuilder.init("builder-canvas","builder-vars"),logInfo("Logic Builder initialized")}catch(e){logError("Failed to initialize Logic Builder",e)}try{var n=document.getElementById("action-btn"),r=document.getElementById("refresh-btn"),o=document.getElementById("tab-variables"),a=document.getElementById("tab-logic"),i=document.getElementById("tab-builder");n&&(n.onclick=function(){return handlePrimaryAction()}),r&&(r.onclick=function(){return tryCatch(scanDocument)}),o&&(o.onclick=function(){return switchTab("variables")}),a&&(a.onclick=function(){return switchTab("logic")}),i&&(i.onclick=function(){return switchTab("builder")}),logInfo("Event listeners attached")}catch(e){logError("Failed to attach event listeners",e)}tryCatch(scanDocument),startAutoRefresh(),logInfo("Add-in initialized successfully")}catch(e){logError("Error during initialization",e)}}else{logError("Unsupported host: ".concat(e.host,". This add-in only works with Word."));var c=document.getElementById("sideload-msg");c&&(c.classList.remove("hidden"),c.innerHTML='\n          <div>\n            <h2 class="text-xl text-gray-600 mb-4">Unsupported Host</h2>\n            <p class="text-sm text-gray-500">This add-in only works with Microsoft Word.</p>\n            <p class="text-xs text-gray-400 mt-2">Current host: '.concat(e.host,"</p>\n          </div>\n        "))}}).catch(function(e){logError("Office.onReady failed",e);var t=document.getElementById("sideload-msg");t&&(t.classList.remove("hidden"),t.innerHTML='\n        <div>\n          <h2 class="text-xl text-red-600 mb-4">Initialization Failed</h2>\n          <p class="text-sm text-gray-500 mb-2">'.concat(e.message||"Unknown error",'</p>\n          <p class="text-xs text-gray-400">Check the browser console (F12) for more details.</p>\n        </div>\n      '))});function startAutoRefresh(){autoRefreshInterval&&clearInterval(autoRefreshInterval),autoRefreshInterval=setInterval(function(){tryCatch(scanDocument)},5e3)}function switchTab(e){currentTab=e;var t={variables:document.getElementById("tab-variables"),logic:document.getElementById("tab-logic"),builder:document.getElementById("tab-builder")},n={variables:document.getElementById("section-variables"),logic:document.getElementById("section-logic"),builder:document.getElementById("section-builder")};Object.values(t).forEach(function(e){e.classList.remove("border-blue-600","text-blue-600"),e.classList.add("border-transparent","text-gray-500");var t=e.querySelector("span");t&&(t.classList.remove("bg-blue-100","text-blue-700"),t.classList.add("bg-gray-100","text-gray-600"))}),Object.values(n).forEach(function(e){return e.classList.add("hidden")});var r=t[e];r.classList.remove("border-transparent","text-gray-500"),r.classList.add("border-blue-600","text-blue-600");var o=r.querySelector("span");o&&(o.classList.remove("bg-gray-100","text-gray-600"),o.classList.add("bg-blue-100","text-blue-700")),n[e].classList.remove("hidden"),updatePrimaryButton()}function updatePrimaryButton(){var e=document.getElementById("action-btn-text"),t=document.getElementById("icon-convert"),n=document.getElementById("icon-insert");"builder"===currentTab?(e.innerText="Insert Logic",t.classList.add("hidden"),n.classList.remove("hidden")):(e.innerText="Convert Selection",t.classList.remove("hidden"),n.classList.add("hidden"))}function handlePrimaryAction(){return _handlePrimaryAction.apply(this,arguments)}function _handlePrimaryAction(){return(_handlePrimaryAction=_asyncToGenerator(_regenerator().m(function e(){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if("builder"!==currentTab){e.n=2;break}return e.n=1,tryCatch(insertLogic);case 1:e.n=3;break;case 2:return e.n=3,tryCatch(convertSelection);case 3:return e.a(2)}},e)}))).apply(this,arguments)}function scanDocument(){return _scanDocument.apply(this,arguments)}function _scanDocument(){return _scanDocument=_asyncToGenerator(_regenerator().m(function e(){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Word.run(function(){var e=_asyncToGenerator(_regenerator().m(function e(t){var n,r,o,a,i,c,s;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return(n=t.document.body).load("text"),e.n=1,t.sync();case 1:r=n.text,o=parseJinja(r),a=o.variables,i=o.logicBlocks,c=o.errors,s=o.variableCounts,renderVariables(a,s),renderLogic(i),renderConsole(c),logicBuilder.updateVariables(a);case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}},e)})),_scanDocument.apply(this,arguments)}function convertSelection(){return _convertSelection.apply(this,arguments)}function _convertSelection(){return _convertSelection=_asyncToGenerator(_regenerator().m(function e(){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Word.run(function(){var e=_asyncToGenerator(_regenerator().m(function e(t){var n,r,o,a;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return(n=t.document.getSelection()).load("text"),e.n=1,t.sync();case 1:if(r=n.text.trim()){e.n=2;break}return e.a(2);case 2:return o=r.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,""),a="{{ ".concat(o," }}"),n.insertText(a,Word.InsertLocation.replace),e.n=3,t.sync();case 3:return e.n=4,scanDocument();case 4:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}},e)})),_convertSelection.apply(this,arguments)}function insertLogic(){return _insertLogic.apply(this,arguments)}function _insertLogic(){return _insertLogic=_asyncToGenerator(_regenerator().m(function e(){var t;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(t=logicBuilder.generateJinja()){e.n=1;break}return e.a(2);case 1:return e.n=2,Word.run(function(){var e=_asyncToGenerator(_regenerator().m(function e(n){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return n.document.getSelection().insertText(t,Word.InsertLocation.replace),e.n=1,n.sync();case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 2:return e.n=3,scanDocument();case 3:return e.a(2)}},e)})),_insertLogic.apply(this,arguments)}function renameVariable(e,t){return _renameVariable.apply(this,arguments)}function _renameVariable(){return _renameVariable=_asyncToGenerator(_regenerator().m(function e(t,n){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(n&&t!==n){e.n=1;break}return e.a(2);case 1:if(n.match(/^[a-zA-Z0-9_]+$/)){e.n=2;break}throw new Error("Invalid variable name. Only letters, numbers, and underscores are allowed.");case 2:return autoRefreshInterval&&clearInterval(autoRefreshInterval),e.n=3,Word.run(function(){var e=_asyncToGenerator(_regenerator().m(function e(r){var o,a,i,c,s,l,u,d;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,o=r.document.body,a="{{ ".concat(t," }}"),i=o.search(a,{matchCase:!0}),r.load(i,"text"),e.n=1,r.sync();case 1:for(c=i.items.length-1;c>=0;c--)i.items[c].insertText("{{ ".concat(n," }}"),Word.InsertLocation.replace);return e.n=2,r.sync();case 2:return s="{{".concat(t,"}}"),l=o.search(s,{matchCase:!0}),r.load(l,"text"),e.n=3,r.sync();case 3:for(u=l.items.length-1;u>=0;u--)l.items[u].insertText("{{ ".concat(n," }}"),Word.InsertLocation.replace);return e.n=4,r.sync();case 4:e.n=6;break;case 5:throw e.p=5,logError("Error in renameVariable",d=e.v),d;case 6:return e.a(2)}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}());case 3:return startAutoRefresh(),e.n=4,scanDocument();case 4:return e.a(2)}},e)})),_renameVariable.apply(this,arguments)}function parseJinja(e){for(var t,n=new Set,r=[],o=new Map,a=[],i=[],c=[],s=/\{\{\s*([a-zA-Z0-9_]+)\s*\}\}/g;null!==(t=s.exec(e));){var l=t[0],u=t[1];l.includes("  ")&&r.push({type:"warning",message:"Extra whitespace in '".concat(l,"'"),index:t.index,length:l.length,snippet:l}),n.add(u),o.set(u,(o.get(u)||0)+1)}for(var d,g=/\{%\s*(.+?)\s*%\}/g;null!==(d=g.exec(e));){var p=d[1].trim(),f="unknown",m=p,h=d[0],y=d.index;p.startsWith("if ")?(f="if",m=p.substring(3),i.push({type:"if",index:y,content:h})):p.startsWith("elif ")?(f="elif",m=p.substring(5),0===i.length&&r.push({type:"error",message:"Unexpected '{% elif ... %}' without 'if'",index:y,length:h.length,snippet:h})):p.startsWith("else")?(f="else",m="(fallback)",0===i.length&&0===c.length&&r.push({type:"error",message:"Unexpected '{% else %}'",index:y,length:h.length,snippet:h})):p.startsWith("endif")?(f="endif",m="",0===i.length?r.push({type:"error",message:"Unexpected '{% endif %}' without 'if'",index:y,length:h.length,snippet:h}):i.pop()):p.startsWith("for ")?(f="for",m=p.substring(4),c.push({type:"for",index:y,content:h})):p.startsWith("endfor")&&(f="endfor",m="",0===c.length?r.push({type:"error",message:"Unexpected '{% endfor %}' without 'for'",index:y,length:h.length,snippet:h}):c.pop()),a.push({type:f,content:p,summary:m,fullMatch:d[0]})}if(i.length>0){var v=i[i.length-1];r.push({type:"error",message:"Unclosed 'if' statement",index:v.index,length:v.content.length,snippet:v.content})}if(c.length>0){var b=c[c.length-1];r.push({type:"error",message:"Unclosed 'for' loop",index:b.index,length:b.content.length,snippet:b.content})}for(var x=/(?<!\{)\{\s*([a-zA-Z0-9_]+)\s*\}\}/g;null!==(t=x.exec(e));)r.push({type:"error",message:"Malformed opening brace: '{ ".concat(t[1]," }}'"),index:t.index,length:t[0].length,snippet:t[0]});for(var _=/\{\{\s*([a-zA-Z0-9_]+)\s*\}(?!\})/g;null!==(t=_.exec(e));)r.push({type:"error",message:"Malformed closing brace: '{{ ".concat(t[1]," }'"),index:t.index,length:t[0].length,snippet:t[0]});return _toConsumableArray(e.matchAll(/\{\{/g)).forEach(function(t){var n=t.index,o=e.slice(n,n+50);o.includes("}}")||o.match(/\{\{\s*[a-zA-Z0-9_]+\s*\}\}/)||(o.includes("\n")||o.length<50)&&r.push({type:"error",message:"Unclosed variable",index:n,length:2,snippet:"{{"})}),[{regex:/\{\{\s*\]/g,msg:"Syntax Error: '{{ ]'"},{regex:/\{\[\s*\}\}/g,msg:"Syntax Error: '{[ }}'"},{regex:/\{\[\s*\}/g,msg:"Syntax Error: '{[ }'"},{regex:/\[\[/g,msg:"Double brackets '[[' detected (use '{{')"},{regex:/\]\]/g,msg:"Double brackets ']]' detected (use '}}')"},{regex:/\{\{\s*\}\}/g,msg:"Empty variable '{{ }}'"},{regex:/(?<!\{)\{\s*[a-zA-Z0-9_]+\s*\}(?!\})/g,msg:"Single braces used '{ var }' (use '{{ var }}')"}].forEach(function(t){for(var n;null!==(n=t.regex.exec(e));)r.push({type:"error",message:"".concat(t.msg," found."),index:n.index,length:n[0].length,snippet:n[0]})}),{variables:Array.from(n).sort(),variableCounts:o,logicBlocks:a,errors:r}}function renderVariables(e,t){if(!document.activeElement||"INPUT"!==document.activeElement.tagName){var n=document.getElementById("variable-list");document.getElementById("var-count").innerText=e.length,n.innerHTML="",0!==e.length?e.forEach(function(e,r){var o=t.get(e)||0,a=r,i=document.createElement("div");i.className="group flex flex-col bg-white p-2 rounded border border-gray-200 hover:border-blue-400 transition-all shadow-sm mb-2",i.innerHTML='\n      <div class="flex items-center justify-between w-full" id="view-'.concat(a,'">\n        <div class="flex items-center gap-2 overflow-hidden">\n            <div class="flex items-center gap-1 text-gray-500 text-xs min-w-[24px]">\n                <span class="bg-gray-100 px-1.5 py-0.5 rounded-full font-mono" title="Occurrences">').concat(o,'</span>\n            </div>\n            <span class="text-blue-600 bg-blue-50 p-0.5 rounded text-[10px] font-mono">{{</span>\n            <span class="font-medium text-gray-700 truncate cursor-pointer hover:text-blue-700" title="Click to rename" onclick="toggleEdit(\'').concat(a,"')\">").concat(e,'</span>\n            <span class="text-blue-600 bg-blue-50 p-0.5 rounded text-[10px] font-mono">}}</span>\n        </div>\n        <div class="flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity">\n             <button class="text-gray-400 hover:text-blue-600 p-1" title="Rename" onclick="toggleEdit(\'').concat(a,'\')">\n                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path></svg>\n            </button>\n            <button class="text-gray-400 hover:text-blue-600 p-1" title="Copy" onclick="navigator.clipboard.writeText(\'{{ ').concat(e,' }}\')">\n                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>\n            </button>\n        </div>\n      </div>\n      \n      <div class="hidden w-full mt-2 flex items-center gap-2" id="edit-').concat(a,'">\n        <input type="text" id="input-').concat(a,'" value="').concat(e,'" data-original="').concat(e,'" class="flex-1 border border-blue-300 rounded px-2 py-1 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500" />\n        <button class="bg-blue-600 text-white px-2 py-1 rounded text-xs hover:bg-blue-700" onclick="saveRename(\'').concat(a,'\')">Save</button>\n        <button class="text-gray-500 hover:text-gray-700 px-1" onclick="toggleEdit(\'').concat(a,"')\">✕</button>\n      </div>\n    "),n.appendChild(i)}):n.innerHTML='<div class="text-center py-8 text-gray-400 italic text-xs">No variables detected. Click Refresh to scan.</div>'}}function renderLogic(e){var t=document.getElementById("logic-list"),n=document.getElementById("logic-count"),r=e.filter(function(e){return!e.type.startsWith("end")&&!e.type.startsWith("elif")&&!e.type.startsWith("else")});n.innerText=r.length,t.innerHTML="",0!==e.length?e.forEach(function(e){var n=document.createElement("div"),r="",o="bg-gray-50 border-gray-200",a="text-gray-600";"if"===e.type?(r='<svg class="w-3 h-3 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>',o="bg-purple-50 border-purple-100",a="text-purple-800 font-medium"):"for"===e.type?(r='<svg class="w-3 h-3 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>',o="bg-green-50 border-green-100",a="text-green-800 font-medium"):e.type.startsWith("end")&&(o="bg-gray-50 border-transparent opacity-60",a="text-gray-400 font-mono text-[10px]"),n.className="flex items-center gap-2 p-1.5 rounded border ".concat(o," text-xs"),n.innerHTML="\n            ".concat(r,'\n            <span class="font-mono ').concat(e.type.startsWith("end")?"pl-4":""," ").concat(a,'">').concat(e.content,"</span>\n        "),t.appendChild(n)}):t.innerHTML='<div class="text-center py-4 text-gray-400 italic text-xs">No control logic detected.</div>'}function renderConsole(e){var t=document.getElementById("console-output"),n=document.getElementById("error-count");t.innerHTML="",e.length>0?(n.innerText=e.length,n.classList.remove("hidden"),e.forEach(function(e){var n=document.createElement("div"),r=void 0!==e.snippet,o=r?"cursor-pointer hover:bg-gray-800":"";"error"===e.type?(n.className="text-red-400 flex gap-2 items-start py-0.5 ".concat(o),n.innerHTML='<span class="text-red-500 font-bold text-xs mt-0.5">✖</span> <span>'.concat(e.message,"</span>")):(n.className="text-yellow-400 flex gap-2 items-start py-0.5 ".concat(o),n.innerHTML='<span class="text-yellow-500 font-bold text-xs mt-0.5">⚠</span> <span>'.concat(e.message,"</span>")),r&&(n.onclick=function(){return navigateToError(e.snippet)},n.title="Go to error location"),t.appendChild(n)})):(n.classList.add("hidden"),t.innerHTML='<div class="text-green-500 flex gap-2 items-center"><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> No errors found.</div>')}function navigateToError(e){return _navigateToError.apply(this,arguments)}function _navigateToError(){return _navigateToError=_asyncToGenerator(_regenerator().m(function e(t){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Word.run(function(){var e=_asyncToGenerator(_regenerator().m(function e(n){var r,o;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return r=n.document.body,o=r.search(t,{matchCase:!0}),n.load(o,"items"),e.n=1,n.sync();case 1:if(!(o.items.length>0)){e.n=2;break}return o.items[0].select(),e.n=2,n.sync();case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}},e)})),_navigateToError.apply(this,arguments)}function tryCatch(e){return _tryCatch.apply(this,arguments)}function _tryCatch(){return(_tryCatch=_asyncToGenerator(_regenerator().m(function e(t){var n,r,o;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,t();case 1:e.n=3;break;case 2:e.p=2,o=e.v,console.error(o),n=document.getElementById("console-output"),(r=document.createElement("div")).className="text-red-400 break-words",r.innerText="System Error: ".concat(o.message),n.appendChild(r);case 3:return e.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}window.toggleEdit=function(e){var t=document.getElementById("view-".concat(e)),n=document.getElementById("edit-".concat(e));t&&n&&(n.classList.contains("hidden")?(t.classList.add("hidden"),n.classList.remove("hidden"),document.getElementById("input-".concat(e)).focus()):(t.classList.remove("hidden"),n.classList.add("hidden")))},window.saveRename=function(){var e=_asyncToGenerator(_regenerator().m(function e(t){var n,r,o;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(!(n=document.getElementById("input-".concat(t)))){e.n=2;break}if(r=n.getAttribute("data-original"),(o=n.value.trim()).match(/^[a-zA-Z0-9_]+$/)){e.n=1;break}return console.error("Invalid variable name"),n.classList.add("border-red-500"),e.a(2);case 1:return toggleEdit(t),e.n=2,tryCatch(function(){return renameVariable(r,o)});case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}();
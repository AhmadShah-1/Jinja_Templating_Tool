{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/logicbuilder.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\r\n * Logic Builder Module\r\n * Handles the UI and Logic generation for the Stanza Logic Builder tab.\r\n */\r\n\r\nexport class LogicBuilder {\r\n    constructor() {\r\n        this.variables = [];\r\n        this.currentBlock = { type: null }; // { type: 'if', conditions: [], else: false }\r\n        this.container = null;\r\n        this.variableContainer = null;\r\n    }\r\n\r\n    init(containerId, variableContainerId) {\r\n        this.container = document.getElementById(containerId);\r\n        this.variableContainer = document.getElementById(variableContainerId);\r\n        this.renderEmptyState();\r\n    }\r\n\r\n    updateVariables(vars) {\r\n        this.variables = vars;\r\n        this.renderVariableList();\r\n    }\r\n\r\n    renderVariableList() {\r\n        if (!this.variableContainer) return;\r\n        \r\n        this.variableContainer.innerHTML = \"\";\r\n        if (this.variables.length === 0) {\r\n            this.variableContainer.innerHTML = `<div class=\"text-gray-400 italic text-xs p-2\">No variables found</div>`;\r\n            return;\r\n        }\r\n\r\n        this.variables.forEach(v => {\r\n            const el = document.createElement(\"div\");\r\n            el.className = \"bg-white border border-gray-200 rounded px-2 py-1 text-xs cursor-grab hover:border-blue-400 mb-1 shadow-sm select-none\";\r\n            el.innerText = v;\r\n            el.draggable = true;\r\n            el.addEventListener(\"dragstart\", (e) => {\r\n                e.dataTransfer.setData(\"text/plain\", v);\r\n                e.dataTransfer.effectAllowed = \"copy\";\r\n            });\r\n            this.variableContainer.appendChild(el);\r\n        });\r\n    }\r\n\r\n    renderEmptyState() {\r\n        this.container.innerHTML = `\r\n            <div class=\"flex flex-col items-center justify-center h-full text-gray-500 space-y-4 mt-8\">\r\n                <p class=\"text-xs italic\">Select a block type to start</p>\r\n                <div class=\"flex flex-wrap gap-2 justify-center\">\r\n                    <button id=\"btn-start-if\" class=\"bg-blue-50 text-blue-600 border border-blue-200 px-3 py-1.5 rounded text-xs hover:bg-blue-100 font-medium\">If Statement</button>\r\n                    <button id=\"btn-start-for\" class=\"bg-green-50 text-green-600 border border-green-200 px-3 py-1.5 rounded text-xs hover:bg-green-100 font-medium\">For Loop</button>\r\n                    <button id=\"btn-start-filter\" class=\"bg-purple-50 text-purple-600 border border-purple-200 px-3 py-1.5 rounded text-xs hover:bg-purple-100 font-medium\">Filter</button>\r\n                </div>\r\n            </div>\r\n        `;\r\n\r\n        document.getElementById(\"btn-start-if\").onclick = () => this.startIf();\r\n        document.getElementById(\"btn-start-for\").onclick = () => this.startFor();\r\n        document.getElementById(\"btn-start-filter\").onclick = () => this.startFilter();\r\n    }\r\n\r\n    startIf() {\r\n        this.currentBlock = {\r\n            type: 'if',\r\n            conditions: [{ left: '', op: '==', right: '', content: '' }], // Initial IF\r\n            elseContent: '',\r\n            hasElse: false\r\n        };\r\n        this.renderIfBuilder();\r\n    }\r\n\r\n    startFor() {\r\n        this.currentBlock = {\r\n            type: 'for',\r\n            iterator: 'item',\r\n            iterable: '',\r\n            content: ''\r\n        };\r\n        this.renderForBuilder();\r\n    }\r\n\r\n    startFilter() {\r\n        this.currentBlock = {\r\n            type: 'filter',\r\n            variable: '',\r\n            filter: 'upper',\r\n            customFilter: ''\r\n        };\r\n        this.renderFilterBuilder();\r\n    }\r\n\r\n    renderIfBuilder() {\r\n        this.container.innerHTML = \"\";\r\n        const wrapper = document.createElement(\"div\");\r\n        wrapper.className = \"space-y-2\";\r\n\r\n        // Header / Reset\r\n        const header = document.createElement(\"div\");\r\n        header.className = \"flex justify-between items-center mb-4\";\r\n        header.innerHTML = `<span class=\"font-bold text-xs text-gray-700\">IF Statement</span>`;\r\n        const resetBtn = document.createElement(\"button\");\r\n        resetBtn.innerText = \"Reset\";\r\n        resetBtn.className = \"text-xs text-red-500 hover:underline\";\r\n        resetBtn.onclick = () => this.renderEmptyState();\r\n        header.appendChild(resetBtn);\r\n        wrapper.appendChild(header);\r\n\r\n        // Conditions (IF + ELIFs)\r\n        this.currentBlock.conditions.forEach((cond, index) => {\r\n            const row = document.createElement(\"div\");\r\n            row.className = \"bg-gray-50 p-2 rounded border border-gray-200 space-y-2 relative group\";\r\n            \r\n            const label = document.createElement(\"div\");\r\n            label.className = \"text-[10px] font-mono font-bold text-blue-600 uppercase\";\r\n            label.innerText = index === 0 ? \"IF\" : \"ELIF\";\r\n            \r\n            // Remove ELIF button\r\n            if (index > 0) {\r\n                const removeBtn = document.createElement(\"button\");\r\n                removeBtn.innerHTML = \"&times;\";\r\n                removeBtn.className = \"absolute top-1 right-2 text-gray-400 hover:text-red-500 text-lg leading-3\";\r\n                removeBtn.onclick = () => {\r\n                    this.currentBlock.conditions.splice(index, 1);\r\n                    this.renderIfBuilder();\r\n                };\r\n                row.appendChild(removeBtn);\r\n            }\r\n\r\n            const inputsRow = document.createElement(\"div\");\r\n            inputsRow.className = \"flex gap-1 items-center\";\r\n\r\n            // Left Input\r\n            const leftIn = this.createDroppableInput(cond.left, (val) => cond.left = val);\r\n            // Operator\r\n            const opSelect = document.createElement(\"select\");\r\n            opSelect.className = \"border border-gray-300 rounded text-xs py-1 px-0.5 bg-white\";\r\n            [\"==\", \"!=\", \">\", \">=\", \"<\", \"<=\", \"in\", \"not in\"].forEach(op => {\r\n                const opt = document.createElement(\"option\");\r\n                opt.value = op;\r\n                opt.innerText = op;\r\n                if (op === cond.op) opt.selected = true;\r\n                opSelect.appendChild(opt);\r\n            });\r\n            opSelect.onchange = (e) => cond.op = e.target.value;\r\n\r\n            // Right Input\r\n            const rightIn = this.createDroppableInput(cond.right, (val) => cond.right = val);\r\n\r\n            inputsRow.appendChild(leftIn);\r\n            inputsRow.appendChild(opSelect);\r\n            inputsRow.appendChild(rightIn);\r\n\r\n            // Action/Content Input\r\n            const contentRow = document.createElement(\"div\");\r\n            contentRow.className = \"mt-1 pt-1 border-t border-gray-200 border-dashed\";\r\n            const contentIn = document.createElement(\"input\");\r\n            contentIn.className = \"w-full border border-gray-300 rounded px-1.5 py-1 text-xs focus:ring-1 focus:ring-blue-500 outline-none transition-colors bg-white\";\r\n            contentIn.placeholder = \"Then output this text...\";\r\n            contentIn.value = cond.content || \"\";\r\n            contentIn.oninput = (e) => cond.content = e.target.value;\r\n            contentRow.appendChild(contentIn);\r\n\r\n            row.appendChild(label);\r\n            row.appendChild(inputsRow);\r\n            row.appendChild(contentRow);\r\n            wrapper.appendChild(row);\r\n        });\r\n\r\n        // ELSE\r\n        if (this.currentBlock.hasElse) {\r\n            const elseRow = document.createElement(\"div\");\r\n            elseRow.className = \"bg-gray-50 p-2 rounded border border-gray-200 relative space-y-2\";\r\n            elseRow.innerHTML = `<span class=\"text-[10px] font-mono font-bold text-blue-600 uppercase\">ELSE</span>`;\r\n            \r\n            const removeBtn = document.createElement(\"button\");\r\n            removeBtn.innerHTML = \"&times;\";\r\n            removeBtn.className = \"absolute top-1 right-2 text-gray-400 hover:text-red-500 text-lg leading-3\";\r\n            removeBtn.onclick = () => {\r\n                this.currentBlock.hasElse = false;\r\n                this.currentBlock.elseContent = '';\r\n                this.renderIfBuilder();\r\n            };\r\n            \r\n            const contentIn = document.createElement(\"input\");\r\n            contentIn.className = \"w-full border border-gray-300 rounded px-1.5 py-1 text-xs focus:ring-1 focus:ring-blue-500 outline-none transition-colors bg-white\";\r\n            contentIn.placeholder = \"Otherwise output this text...\";\r\n            contentIn.value = this.currentBlock.elseContent || \"\";\r\n            contentIn.oninput = (e) => this.currentBlock.elseContent = e.target.value;\r\n\r\n            elseRow.appendChild(removeBtn);\r\n            elseRow.appendChild(contentIn);\r\n            wrapper.appendChild(elseRow);\r\n        }\r\n\r\n        // Controls (+ / -)\r\n        const controls = document.createElement(\"div\");\r\n        controls.className = \"flex gap-2 mt-2\";\r\n\r\n        const addElifBtn = document.createElement(\"button\");\r\n        addElifBtn.className = \"flex-1 bg-blue-50 text-blue-600 border border-blue-200 rounded py-1 text-lg font-bold hover:bg-blue-100\";\r\n        addElifBtn.innerText = \"+\";\r\n        addElifBtn.title = \"Add ELIF\";\r\n        addElifBtn.onclick = () => {\r\n            this.currentBlock.conditions.push({ left: '', op: '==', right: '', content: '' });\r\n            this.renderIfBuilder();\r\n        };\r\n\r\n        const addElseBtn = document.createElement(\"button\");\r\n        addElseBtn.className = \"flex-1 bg-gray-100 text-gray-600 border border-gray-300 rounded py-1 text-lg font-bold hover:bg-gray-200 disabled:opacity-50\";\r\n        addElseBtn.innerText = \"-\";\r\n        addElseBtn.title = \"Add ELSE\";\r\n        addElseBtn.disabled = this.currentBlock.hasElse;\r\n        addElseBtn.onclick = () => {\r\n            this.currentBlock.hasElse = true;\r\n            this.renderIfBuilder();\r\n        };\r\n\r\n        controls.appendChild(addElifBtn);\r\n        controls.appendChild(addElseBtn);\r\n        wrapper.appendChild(controls);\r\n\r\n        this.container.appendChild(wrapper);\r\n    }\r\n\r\n    renderForBuilder() {\r\n        this.container.innerHTML = \"\";\r\n        const wrapper = document.createElement(\"div\");\r\n        wrapper.className = \"space-y-2\";\r\n\r\n        // Header / Reset\r\n        const header = document.createElement(\"div\");\r\n        header.className = \"flex justify-between items-center mb-4\";\r\n        header.innerHTML = `<span class=\"font-bold text-xs text-gray-700\">FOR Loop</span>`;\r\n        const resetBtn = document.createElement(\"button\");\r\n        resetBtn.innerText = \"Reset\";\r\n        resetBtn.className = \"text-xs text-red-500 hover:underline\";\r\n        resetBtn.onclick = () => this.renderEmptyState();\r\n        header.appendChild(resetBtn);\r\n        wrapper.appendChild(header);\r\n\r\n        const row = document.createElement(\"div\");\r\n        row.className = \"bg-gray-50 p-2 rounded border border-gray-200 space-y-2\";\r\n        \r\n        const label = document.createElement(\"div\");\r\n        label.className = \"text-[10px] font-mono font-bold text-green-600 uppercase\";\r\n        label.innerText = \"FOR\";\r\n        \r\n        const inputsRow = document.createElement(\"div\");\r\n        inputsRow.className = \"flex gap-1 items-center text-xs\";\r\n\r\n        // Iterator (e.g. 'item')\r\n        const iterInput = document.createElement(\"input\");\r\n        iterInput.className = \"w-1/3 border border-gray-300 rounded px-1 py-1\";\r\n        iterInput.placeholder = \"item\";\r\n        iterInput.value = this.currentBlock.iterator;\r\n        iterInput.oninput = (e) => this.currentBlock.iterator = e.target.value;\r\n\r\n        const inLabel = document.createElement(\"span\");\r\n        inLabel.innerText = \"in\";\r\n        inLabel.className = \"font-bold text-gray-500\";\r\n\r\n        // Iterable (e.g. 'items') - Droppable\r\n        const iterableInput = this.createDroppableInput(this.currentBlock.iterable, (val) => this.currentBlock.iterable = val);\r\n        iterableInput.classList.remove(\"w-full\");\r\n        iterableInput.classList.add(\"flex-1\");\r\n\r\n        inputsRow.appendChild(iterInput);\r\n        inputsRow.appendChild(inLabel);\r\n        inputsRow.appendChild(iterableInput);\r\n\r\n        // Content Input\r\n        const contentRow = document.createElement(\"div\");\r\n        contentRow.className = \"mt-1 pt-1 border-t border-gray-200 border-dashed\";\r\n        const contentIn = document.createElement(\"input\");\r\n        contentIn.className = \"w-full border border-gray-300 rounded px-1.5 py-1 text-xs focus:ring-1 focus:ring-blue-500 outline-none transition-colors bg-white\";\r\n        contentIn.placeholder = \"Repeat this text...\";\r\n        contentIn.value = this.currentBlock.content || \"\";\r\n        contentIn.oninput = (e) => this.currentBlock.content = e.target.value;\r\n        contentRow.appendChild(contentIn);\r\n\r\n        row.appendChild(label);\r\n        row.appendChild(inputsRow);\r\n        row.appendChild(contentRow);\r\n        wrapper.appendChild(row);\r\n        \r\n        this.container.appendChild(wrapper);\r\n    }\r\n\r\n    renderFilterBuilder() {\r\n        this.container.innerHTML = \"\";\r\n        const wrapper = document.createElement(\"div\");\r\n        wrapper.className = \"space-y-2\";\r\n\r\n        // Header / Reset\r\n        const header = document.createElement(\"div\");\r\n        header.className = \"flex justify-between items-center mb-4\";\r\n        header.innerHTML = `<span class=\"font-bold text-xs text-gray-700\">Filter Variable</span>`;\r\n        const resetBtn = document.createElement(\"button\");\r\n        resetBtn.innerText = \"Reset\";\r\n        resetBtn.className = \"text-xs text-red-500 hover:underline\";\r\n        resetBtn.onclick = () => this.renderEmptyState();\r\n        header.appendChild(resetBtn);\r\n        wrapper.appendChild(header);\r\n\r\n        const row = document.createElement(\"div\");\r\n        row.className = \"bg-gray-50 p-2 rounded border border-gray-200 space-y-3\";\r\n        \r\n        // Variable Input\r\n        const varGroup = document.createElement(\"div\");\r\n        varGroup.className = \"space-y-1\";\r\n        varGroup.innerHTML = `<label class=\"text-[10px] font-bold text-gray-500 uppercase block\">Variable</label>`;\r\n        const varInput = this.createDroppableInput(this.currentBlock.variable, (val) => this.currentBlock.variable = val);\r\n        varGroup.appendChild(varInput);\r\n        \r\n        // Filter Selector\r\n        const filterGroup = document.createElement(\"div\");\r\n        filterGroup.className = \"space-y-1\";\r\n        filterGroup.innerHTML = `<label class=\"text-[10px] font-bold text-gray-500 uppercase block\">Filter</label>`;\r\n        \r\n        const filterSelect = document.createElement(\"select\");\r\n        filterSelect.className = \"w-full border border-gray-300 rounded px-1.5 py-1 text-xs bg-white focus:ring-1 focus:ring-purple-500 outline-none\";\r\n        \r\n        const filters = [\r\n            \"upper\", \"lower\", \"title\", \"capitalize\", \"trim\", \r\n            \"length\", \"round\", \"abs\", \"first\", \"last\", \"safe\", \"custom\"\r\n        ];\r\n        \r\n        filters.forEach(f => {\r\n            const opt = document.createElement(\"option\");\r\n            opt.value = f;\r\n            opt.innerText = f;\r\n            if (f === this.currentBlock.filter) opt.selected = true;\r\n            filterSelect.appendChild(opt);\r\n        });\r\n\r\n        // Custom Filter Input\r\n        const customInput = document.createElement(\"input\");\r\n        customInput.className = \"w-full border border-gray-300 rounded px-1.5 py-1 text-xs bg-white focus:ring-1 focus:ring-purple-500 outline-none mt-1 hidden\";\r\n        customInput.placeholder = \"Enter custom filter name\";\r\n        customInput.value = this.currentBlock.customFilter || \"\";\r\n        if (this.currentBlock.filter === 'custom') customInput.classList.remove('hidden');\r\n\r\n        customInput.oninput = (e) => this.currentBlock.customFilter = e.target.value;\r\n\r\n        filterSelect.onchange = (e) => {\r\n             this.currentBlock.filter = e.target.value;\r\n             if (e.target.value === 'custom') {\r\n                 customInput.classList.remove('hidden');\r\n                 customInput.focus();\r\n             } else {\r\n                 customInput.classList.add('hidden');\r\n             }\r\n        };\r\n        \r\n        filterGroup.appendChild(filterSelect);\r\n        filterGroup.appendChild(customInput);\r\n\r\n        row.appendChild(varGroup);\r\n        row.appendChild(filterGroup);\r\n        wrapper.appendChild(row);\r\n        \r\n        this.container.appendChild(wrapper);\r\n    }\r\n\r\n    createDroppableInput(initialValue, onChange) {\r\n        const input = document.createElement(\"input\");\r\n        input.type = \"text\";\r\n        input.className = \"w-full border border-gray-300 rounded px-1.5 py-1 text-xs focus:ring-1 focus:ring-blue-500 outline-none transition-colors\";\r\n        input.value = initialValue || \"\";\r\n        input.placeholder = \"Value / Drag Var\";\r\n        \r\n        input.oninput = (e) => onChange(e.target.value);\r\n\r\n        // Drag Events\r\n        input.ondragover = (e) => {\r\n            e.preventDefault();\r\n            input.classList.add(\"border-blue-500\", \"bg-blue-50\");\r\n        };\r\n\r\n        input.ondragleave = () => {\r\n            input.classList.remove(\"border-blue-500\", \"bg-blue-50\");\r\n        };\r\n\r\n        input.ondrop = (e) => {\r\n            e.preventDefault();\r\n            input.classList.remove(\"border-blue-500\", \"bg-blue-50\");\r\n            const varName = e.dataTransfer.getData(\"text/plain\");\r\n            if (varName) {\r\n                // If input is empty, just set it. If has content, append?\r\n                // For logic building, usually replacing or appending to cursor is best.\r\n                // Simple MVP: Append\r\n                const start = input.selectionStart;\r\n                const end = input.selectionEnd;\r\n                const text = input.value;\r\n                const newVal = text.substring(0, start) + varName + text.substring(end);\r\n                input.value = newVal;\r\n                onChange(newVal);\r\n                input.focus();\r\n            }\r\n        };\r\n\r\n        return input;\r\n    }\r\n\r\n    generateJinja() {\r\n        if (!this.currentBlock.type) return \"\";\r\n\r\n        if (this.currentBlock.type === 'if') {\r\n            let output = \"\";\r\n            this.currentBlock.conditions.forEach((cond, index) => {\r\n                const tag = index === 0 ? \"if\" : \"elif\";\r\n                // Simple validation: if inputs are empty, use placeholders\r\n                const left = cond.left || \"var\";\r\n                const right = cond.right || \"value\";\r\n                const content = cond.content ? ` ${cond.content}` : \"\";\r\n                \r\n                // Construct: {% if left op right %} content\r\n                // No newlines as requested for inline flow\r\n                output += `{% ${tag} ${left} ${cond.op} ${right} %}${content}`;\r\n            });\r\n            \r\n            if (this.currentBlock.hasElse) {\r\n                const elseContent = this.currentBlock.elseContent ? ` ${this.currentBlock.elseContent}` : \"\";\r\n                output += `{% else %}${elseContent}`;\r\n            }\r\n            \r\n            output += `{% endif %}`;\r\n            return output;\r\n        }\r\n\r\n        if (this.currentBlock.type === 'for') {\r\n            const iter = this.currentBlock.iterator || \"item\";\r\n            const list = this.currentBlock.iterable || \"items\";\r\n            const content = this.currentBlock.content ? ` ${this.currentBlock.content}` : \"\";\r\n            // Inline For Loop\r\n            return `{% for ${iter} in ${list} %}${content}{% endfor %}`;\r\n        }\r\n\r\n        if (this.currentBlock.type === 'filter') {\r\n            const v = this.currentBlock.variable || \"var\";\r\n            let f = this.currentBlock.filter || \"upper\";\r\n            if (f === 'custom') {\r\n                f = this.currentBlock.customFilter || \"custom_filter\";\r\n            }\r\n            return `{{ ${v} | ${f} }}`;\r\n        }\r\n\r\n        return \"\";\r\n    }\r\n}\r\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global document, Office, Word, setInterval, clearInterval */\n\nimport { LogicBuilder } from \"./logicbuilder\";\n\nlet autoRefreshInterval;\nlet currentTab = 'variables';\nconst logicBuilder = new LogicBuilder();\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Word) {\n    document.getElementById(\"sideload-msg\").style.display = \"none\";\n    \n    // Initialize Logic Builder\n    logicBuilder.init(\"builder-canvas\", \"builder-vars\");\n\n    // Attach event listeners\n    document.getElementById(\"action-btn\").onclick = () => handlePrimaryAction();\n    document.getElementById(\"refresh-btn\").onclick = () => tryCatch(scanDocument);\n    \n    // Tab Listeners\n    document.getElementById(\"tab-variables\").onclick = () => switchTab('variables');\n    document.getElementById(\"tab-logic\").onclick = () => switchTab('logic');\n    document.getElementById(\"tab-builder\").onclick = () => switchTab('builder');\n    \n    // Initial scan\n    tryCatch(scanDocument);\n\n    // Start Auto-Refresh (Every 5 seconds)\n    startAutoRefresh();\n  }\n});\n\nfunction startAutoRefresh() {\n    if (autoRefreshInterval) clearInterval(autoRefreshInterval);\n    autoRefreshInterval = setInterval(() => {\n        tryCatch(scanDocument);\n    }, 5000);\n}\n\n/**\n * Tab Switching Logic\n */\nfunction switchTab(tabName) {\n    currentTab = tabName;\n    const tabs = {\n        variables: document.getElementById(\"tab-variables\"),\n        logic: document.getElementById(\"tab-logic\"),\n        builder: document.getElementById(\"tab-builder\")\n    };\n    const sections = {\n        variables: document.getElementById(\"section-variables\"),\n        logic: document.getElementById(\"section-logic\"),\n        builder: document.getElementById(\"section-builder\")\n    };\n\n    // Reset all\n    Object.values(tabs).forEach(t => {\n        t.classList.remove(\"border-blue-600\", \"text-blue-600\");\n        t.classList.add(\"border-transparent\", \"text-gray-500\");\n        const badge = t.querySelector(\"span\");\n        if (badge) {\n            badge.classList.remove(\"bg-blue-100\", \"text-blue-700\");\n            badge.classList.add(\"bg-gray-100\", \"text-gray-600\");\n        }\n    });\n    Object.values(sections).forEach(s => s.classList.add(\"hidden\"));\n\n    // Activate current\n    const activeTab = tabs[tabName];\n    activeTab.classList.remove(\"border-transparent\", \"text-gray-500\");\n    activeTab.classList.add(\"border-blue-600\", \"text-blue-600\");\n    const badge = activeTab.querySelector(\"span\");\n    if (badge) {\n        badge.classList.remove(\"bg-gray-100\", \"text-gray-600\");\n        badge.classList.add(\"bg-blue-100\", \"text-blue-700\");\n    }\n    sections[tabName].classList.remove(\"hidden\");\n\n    updatePrimaryButton();\n}\n\nfunction updatePrimaryButton() {\n    const btnText = document.getElementById(\"action-btn-text\");\n    const iconConvert = document.getElementById(\"icon-convert\");\n    const iconInsert = document.getElementById(\"icon-insert\");\n\n    if (currentTab === 'builder') {\n        btnText.innerText = \"Insert Logic\";\n        iconConvert.classList.add(\"hidden\");\n        iconInsert.classList.remove(\"hidden\");\n    } else {\n        btnText.innerText = \"Convert Selection\";\n        iconConvert.classList.remove(\"hidden\");\n        iconInsert.classList.add(\"hidden\");\n    }\n}\n\nasync function handlePrimaryAction() {\n    if (currentTab === 'builder') {\n        await tryCatch(insertLogic);\n    } else {\n        await tryCatch(convertSelection);\n    }\n}\n\n/**\n * Scans the document for Jinja2 variables, logic, and validation errors.\n */\nasync function scanDocument() {\n  await Word.run(async (context) => {\n    // get body text\n    const body = context.document.body;\n    body.load(\"text\");\n    await context.sync();\n\n    const text = body.text;\n    \n    // Parse variables, logic, and find errors\n    const { variables, logicBlocks, errors, variableCounts } = parseJinja(text);\n\n    // Update UI\n    renderVariables(variables, variableCounts);\n    renderLogic(logicBlocks);\n    renderConsole(errors);\n\n    // Update Logic Builder with found variables\n    logicBuilder.updateVariables(variables);\n  });\n}\n\n/**\n * Converts currently selected text into a Jinja2 variable.\n */\nasync function convertSelection() {\n  await Word.run(async (context) => {\n    const selection = context.document.getSelection();\n    selection.load(\"text\");\n    await context.sync();\n\n    const rawText = selection.text.trim();\n    if (!rawText) return; // No text selected\n\n    // Sanitize: \"Customer Name\" -> \"customer_name\"\n    const cleanName = rawText\n      .toLowerCase()\n      .replace(/[^a-z0-9]+/g, \"_\")\n      .replace(/_+/g, \"_\")\n      .replace(/^_|_$/g, \"\");\n\n    const newVar = `{{ ${cleanName} }}`;\n    \n    // Insert/Replace\n    selection.insertText(newVar, Word.InsertLocation.replace);\n    await context.sync();\n    \n    // Refresh the list\n    await scanDocument();\n  });\n}\n\n/**\n * Inserts the generated logic from the builder into the document\n */\nasync function insertLogic() {\n    const jinjaCode = logicBuilder.generateJinja();\n    if (!jinjaCode) return;\n\n    await Word.run(async (context) => {\n        const selection = context.document.getSelection();\n        selection.insertText(jinjaCode, Word.InsertLocation.replace);\n        await context.sync();\n    });\n    \n    await scanDocument();\n}\n\n\n/**\n * Renames a variable throughout the document\n */\nasync function renameVariable(oldName, newName) {\n  if (!newName || oldName === newName) return;\n\n  if (autoRefreshInterval) clearInterval(autoRefreshInterval);\n\n  await Word.run(async (context) => {\n      const body = context.document.body;\n      \n      // Use wildcards to find {{ ... }} blocks\n      const searchResults = body.search(\"\\\\{\\\\{*\\\\}\\\\}\", { matchWildcards: true });\n      context.load(searchResults, 'text');\n      await context.sync();\n      \n      for (let i = searchResults.items.length - 1; i >= 0; i--) {\n          const item = searchResults.items[i];\n          const text = item.text;\n          const match = /\\{\\{\\s*([a-zA-Z0-9_]+)\\s*\\}\\}/.exec(text);\n          if (match && match[1] === oldName) {\n              item.insertText(`{{ ${newName} }}`, Word.InsertLocation.replace);\n          }\n      }\n      await context.sync();\n  });\n\n  startAutoRefresh();\n  await scanDocument();\n}\n\n/**\n * Regex Logic\n */\nfunction parseJinja(text) {\n  const variables = new Set();\n  const errors = [];\n  const variableMap = new Map(); // Name -> count\n  const logicBlocks = [];\n  \n  // Stacks for validation\n  const ifStack = [];\n  const forStack = [];\n\n  // 1. Find Valid Variables: {{ variable_name }}\n  const validPattern = /\\{\\{\\s*([a-zA-Z0-9_]+)\\s*\\}\\}/g;\n  let match;\n  \n  while ((match = validPattern.exec(text)) !== null) {\n    const fullMatch = match[0];\n    const varName = match[1];\n    if (fullMatch.includes(\"  \")) {\n      errors.push({\n        type: \"warning\",\n        message: `Extra whitespace in '${fullMatch}'`,\n        index: match.index,\n        length: fullMatch.length,\n        snippet: fullMatch // Add snippet\n      });\n    }\n    variables.add(varName);\n    variableMap.set(varName, (variableMap.get(varName) || 0) + 1);\n  }\n\n  // 2. Find Control Logic: {% ... %}\n  const logicPattern = /\\{%\\s*(.+?)\\s*%\\}/g;\n  let lMatch;\n  \n  while ((lMatch = logicPattern.exec(text)) !== null) {\n      const content = lMatch[1].trim();\n      let type = \"unknown\";\n      let summary = content;\n      const fullMatch = lMatch[0];\n      const index = lMatch.index;\n\n      if (content.startsWith(\"if \")) {\n          type = \"if\";\n          summary = content.substring(3); \n          ifStack.push({ type: 'if', index: index, content: fullMatch });\n      } else if (content.startsWith(\"elif \")) {\n          type = \"elif\";\n          summary = content.substring(5);\n          if (ifStack.length === 0) {\n              errors.push({ type: \"error\", message: `Unexpected '{% elif ... %}' without 'if'`, index: index, length: fullMatch.length, snippet: fullMatch });\n          }\n      } else if (content.startsWith(\"else\")) {\n          type = \"else\";\n          summary = \"(fallback)\";\n          if (ifStack.length === 0 && forStack.length === 0) {\n              errors.push({ type: \"error\", message: `Unexpected '{% else %}'`, index: index, length: fullMatch.length, snippet: fullMatch });\n          }\n      } else if (content.startsWith(\"endif\")) {\n          type = \"endif\";\n          summary = \"\";\n          if (ifStack.length === 0) {\n              errors.push({ type: \"error\", message: `Unexpected '{% endif %}' without 'if'`, index: index, length: fullMatch.length, snippet: fullMatch });\n          } else {\n              ifStack.pop();\n          }\n      } else if (content.startsWith(\"for \")) {\n          type = \"for\";\n          summary = content.substring(4);\n          forStack.push({ type: 'for', index: index, content: fullMatch });\n      } else if (content.startsWith(\"endfor\")) {\n          type = \"endfor\";\n          summary = \"\";\n          if (forStack.length === 0) {\n              errors.push({ type: \"error\", message: `Unexpected '{% endfor %}' without 'for'`, index: index, length: fullMatch.length, snippet: fullMatch });\n          } else {\n              forStack.pop();\n          }\n      }\n\n      logicBlocks.push({\n          type,\n          content,\n          summary,\n          fullMatch: lMatch[0]\n      });\n  }\n\n  // Check for unclosed blocks at end of file\n  if (ifStack.length > 0) {\n      const unclosed = ifStack[ifStack.length - 1];\n      errors.push({ type: \"error\", message: `Unclosed 'if' statement`, index: unclosed.index, length: unclosed.content.length, snippet: unclosed.content });\n  }\n  if (forStack.length > 0) {\n      const unclosed = forStack[forStack.length - 1];\n      errors.push({ type: \"error\", message: `Unclosed 'for' loop`, index: unclosed.index, length: unclosed.content.length, snippet: unclosed.content });\n  }\n\n  // 3. Validation / Error Scanning (Variables)\n  const singleOpenRegex = /(?<!\\{)\\{\\s*([a-zA-Z0-9_]+)\\s*\\}\\}/g;\n  while ((match = singleOpenRegex.exec(text)) !== null) {\n      errors.push({ type: \"error\", message: `Malformed opening brace: '{ ${match[1]} }}'`, index: match.index, length: match[0].length, snippet: match[0] });\n  }\n\n  const singleCloseRegex = /\\{\\{\\s*([a-zA-Z0-9_]+)\\s*\\}(?!\\})/g;\n  while ((match = singleCloseRegex.exec(text)) !== null) {\n      errors.push({ type: \"error\", message: `Malformed closing brace: '{{ ${match[1]} }'`, index: match.index, length: match[0].length, snippet: match[0] });\n  }\n\n  const openBraces = [...text.matchAll(/\\{\\{/g)];\n  openBraces.forEach(m => {\n      const idx = m.index;\n      const slice = text.slice(idx, idx + 50);\n      if (!slice.includes(\"}}\")) {\n          if (!slice.match(/\\{\\{\\s*[a-zA-Z0-9_]+\\s*\\}\\}/)) {\n               if (slice.includes(\"\\n\") || slice.length < 50) { \n                   errors.push({ type: \"error\", message: `Unclosed variable`, index: idx, length: 2, snippet: \"{{\" });\n               }\n          }\n      }\n  });\n\n  const badPatterns = [\n      { regex: /\\{\\{\\s*\\]/g, msg: \"Syntax Error: '{{ ]'\" },       \n      { regex: /\\{\\[\\s*\\}\\}/g, msg: \"Syntax Error: '{[ }}'\" },    \n      { regex: /\\{\\[\\s*\\}/g, msg: \"Syntax Error: '{[ }'\" },       \n      { regex: /\\[\\[/g, msg: \"Double brackets '[[' detected (use '{{')\" },\n      { regex: /\\]\\]/g, msg: \"Double brackets ']]' detected (use '}}')\" },\n      { regex: /\\{\\{\\s*\\}\\}/g, msg: \"Empty variable '{{ }}'\" },\n      { regex: /(?<!\\{)\\{\\s*[a-zA-Z0-9_]+\\s*\\}(?!\\})/g, msg: \"Single braces used '{ var }' (use '{{ var }}')\" }\n  ];\n\n  badPatterns.forEach(p => {\n      let errMatch;\n      while ((errMatch = p.regex.exec(text)) !== null) {\n           errors.push({ type: \"error\", message: `${p.msg} found.`, index: errMatch.index, length: errMatch[0].length, snippet: errMatch[0] });\n      }\n  });\n\n  return { \n    variables: Array.from(variables).sort(),\n    variableCounts: variableMap,\n    logicBlocks,\n    errors \n  };\n}\n\n/**\n * UI Rendering\n */\nfunction renderVariables(variables, variableCounts) {\n  if (document.activeElement && document.activeElement.tagName === \"INPUT\") {\n      return;\n  }\n\n  const list = document.getElementById(\"variable-list\");\n  const countSpan = document.getElementById(\"var-count\");\n  \n  countSpan.innerText = variables.length;\n  list.innerHTML = \"\";\n\n  if (variables.length === 0) {\n    list.innerHTML = `<div class=\"text-center py-8 text-gray-400 italic text-xs\">No variables detected. Click Refresh to scan.</div>`;\n    return;\n  }\n\n  variables.forEach((v, index) => {\n    const count = variableCounts.get(v) || 0;\n    const safeId = index; \n    \n    const item = document.createElement(\"div\");\n    item.className = \"group flex flex-col bg-white p-2 rounded border border-gray-200 hover:border-blue-400 transition-all shadow-sm mb-2\";\n    \n    // Render View Mode\n    item.innerHTML = `\n      <div class=\"flex items-center justify-between w-full\" id=\"view-${safeId}\">\n        <div class=\"flex items-center gap-2 overflow-hidden\">\n            <div class=\"flex items-center gap-1 text-gray-500 text-xs min-w-[24px]\">\n                <span class=\"bg-gray-100 px-1.5 py-0.5 rounded-full font-mono\" title=\"Occurrences\">${count}</span>\n            </div>\n            <span class=\"text-blue-600 bg-blue-50 p-0.5 rounded text-[10px] font-mono\">{{</span>\n            <span class=\"font-medium text-gray-700 truncate cursor-pointer hover:text-blue-700\" title=\"Click to rename\" onclick=\"toggleEdit('${safeId}')\">${v}</span>\n            <span class=\"text-blue-600 bg-blue-50 p-0.5 rounded text-[10px] font-mono\">}}</span>\n        </div>\n        <div class=\"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity\">\n             <button class=\"text-gray-400 hover:text-blue-600 p-1\" title=\"Rename\" onclick=\"toggleEdit('${safeId}')\">\n                <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\"></path></svg>\n            </button>\n            <button class=\"text-gray-400 hover:text-blue-600 p-1\" title=\"Copy\" onclick=\"navigator.clipboard.writeText('{{ ${v} }}')\">\n                <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\"></path></svg>\n            </button>\n        </div>\n      </div>\n      \n      <div class=\"hidden w-full mt-2 flex items-center gap-2\" id=\"edit-${safeId}\">\n        <input type=\"text\" id=\"input-${safeId}\" value=\"${v}\" data-original=\"${v}\" class=\"flex-1 border border-blue-300 rounded px-2 py-1 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500\" />\n        <button class=\"bg-blue-600 text-white px-2 py-1 rounded text-xs hover:bg-blue-700\" onclick=\"saveRename('${safeId}')\">Save</button>\n        <button class=\"text-gray-500 hover:text-gray-700 px-1\" onclick=\"toggleEdit('${safeId}')\"></button>\n      </div>\n    `;\n    list.appendChild(item);\n  });\n}\n\nfunction renderLogic(logicBlocks) {\n    const list = document.getElementById(\"logic-list\");\n    const countSpan = document.getElementById(\"logic-count\");\n\n    const meaningfulBlocks = logicBlocks.filter(l => !l.type.startsWith('end') && !l.type.startsWith('elif') && !l.type.startsWith('else'));\n    countSpan.innerText = meaningfulBlocks.length;\n    list.innerHTML = \"\";\n\n    if (logicBlocks.length === 0) {\n        list.innerHTML = `<div class=\"text-center py-4 text-gray-400 italic text-xs\">No control logic detected.</div>`;\n        return;\n    }\n\n    logicBlocks.forEach(block => {\n        const item = document.createElement(\"div\");\n        let icon = \"\";\n        let colorClass = \"bg-gray-50 border-gray-200\";\n        let textClass = \"text-gray-600\";\n\n        if (block.type === 'if') {\n            icon = `<svg class=\"w-3 h-3 text-purple-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"></path></svg>`;\n            colorClass = \"bg-purple-50 border-purple-100\";\n            textClass = \"text-purple-800 font-medium\";\n        } else if (block.type === 'for') {\n            icon = `<svg class=\"w-3 h-3 text-green-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"></path></svg>`;\n            colorClass = \"bg-green-50 border-green-100\";\n            textClass = \"text-green-800 font-medium\";\n        } else if (block.type.startsWith('end')) {\n             colorClass = \"bg-gray-50 border-transparent opacity-60\";\n             textClass = \"text-gray-400 font-mono text-[10px]\";\n        }\n\n        item.className = `flex items-center gap-2 p-1.5 rounded border ${colorClass} text-xs`;\n        item.innerHTML = `\n            ${icon}\n            <span class=\"font-mono ${block.type.startsWith('end') ? 'pl-4' : ''} ${textClass}\">${block.content}</span>\n        `;\n        \n        list.appendChild(item);\n    });\n}\n\nfunction renderConsole(errors) {\n  const consoleOutput = document.getElementById(\"console-output\");\n  const errorCountBadge = document.getElementById(\"error-count\");\n  consoleOutput.innerHTML = \"\";\n  \n  if (errors.length > 0) {\n    errorCountBadge.innerText = errors.length;\n    errorCountBadge.classList.remove(\"hidden\");\n    \n    errors.forEach(err => {\n      const line = document.createElement(\"div\");\n      const clickable = err.snippet !== undefined; // Only clickable if we captured a snippet\n      const cursorClass = clickable ? \"cursor-pointer hover:bg-gray-800\" : \"\";\n      \n      if (err.type === 'error') {\n          line.className = `text-red-400 flex gap-2 items-start py-0.5 ${cursorClass}`;\n          line.innerHTML = `<span class=\"text-red-500 font-bold text-xs mt-0.5\"></span> <span>${err.message}</span>`;\n      } else {\n          line.className = `text-yellow-400 flex gap-2 items-start py-0.5 ${cursorClass}`;\n          line.innerHTML = `<span class=\"text-yellow-500 font-bold text-xs mt-0.5\"></span> <span>${err.message}</span>`;\n      }\n      \n      if (clickable) {\n          line.onclick = () => navigateToError(err.snippet);\n          line.title = \"Go to error location\";\n      }\n      \n      consoleOutput.appendChild(line);\n    });\n  } else {\n    errorCountBadge.classList.add(\"hidden\");\n    consoleOutput.innerHTML = `<div class=\"text-green-500 flex gap-2 items-center\"><svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 13l4 4L19 7\"></path></svg> No errors found.</div>`;\n  }\n}\n\nasync function navigateToError(snippet) {\n    await Word.run(async (context) => {\n        const body = context.document.body;\n        // Search for the snippet text\n        // We use a specific logic: Find the first occurrence? \n        // Since we can't easily map index to range, we search for the snippet.\n        // This might select the *first* error if there are duplicates, but it's a good start.\n        const searchResults = body.search(snippet, { matchCase: true });\n        context.load(searchResults, 'items');\n        await context.sync();\n        \n        if (searchResults.items.length > 0) {\n            // Select the first match found. \n            // Ideally we'd find the exact one based on context, but that's hard without unique IDs.\n            searchResults.items[0].select();\n            await context.sync();\n        }\n    });\n}\n\n// Helpers for Edit Mode\nwindow.toggleEdit = (id) => {\n    const view = document.getElementById(`view-${id}`);\n    const edit = document.getElementById(`edit-${id}`);\n    if (view && edit) {\n        const isEditing = edit.classList.contains('hidden');\n        if (isEditing) {\n            view.classList.add('hidden');\n            edit.classList.remove('hidden');\n            document.getElementById(`input-${id}`).focus();\n        } else {\n            view.classList.remove('hidden');\n            edit.classList.add('hidden');\n        }\n    }\n};\n\nwindow.saveRename = async (id) => {\n    const input = document.getElementById(`input-${id}`);\n    if (input) {\n        const oldName = input.getAttribute(\"data-original\");\n        const newName = input.value.trim();\n        \n        if (!newName.match(/^[a-zA-Z0-9_]+$/)) {\n            console.error(\"Invalid variable name\");\n            input.classList.add(\"border-red-500\");\n            return;\n        }\n        \n        toggleEdit(id);\n        await tryCatch(() => renameVariable(oldName, newName));\n    }\n};\n\n\n/** Default helper for invoking an action and handling errors. */\nasync function tryCatch(callback) {\n  try {\n      await callback();\n  } catch (error) {\n      console.error(error);\n    const consoleOutput = document.getElementById(\"console-output\");\n    const line = document.createElement(\"div\");\n    line.className = \"text-red-400 break-words\";\n    line.innerText = `System Error: ${error.message}`;\n    consoleOutput.appendChild(line);\n  }\n}\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"../../assets/PVEDI.png\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_2___ = new URL(\"./taskpane.js\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html lang=\\\"en\\\"> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Stanza Template Assistant</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <\" + \"script src=\\\"https://cdn.tailwindcss.com\\\"><\" + \"/script> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"bg-gray-50 h-screen flex flex-col font-sans text-sm text-gray-800 overflow-hidden\\\"> <header class=\\\"bg-white border-b border-gray-200 p-4 flex items-center shadow-sm z-10\\\"> <img width=\\\"32\\\" height=\\\"32\\\" src=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\" alt=\\\"Stanza\\\" class=\\\"mr-3\\\"/> <h1 class=\\\"font-bold text-lg text-gray-900 tracking-tight\\\">Stanza</h1> </header> <div class=\\\"bg-gray-100 p-3 border-b border-gray-200 flex gap-2\\\"> <button id=\\\"action-btn\\\" class=\\\"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium py-1.5 px-3 rounded shadow transition-colors flex items-center justify-center gap-1 text-xs\\\" title=\\\"Action\\\"> <svg id=\\\"icon-convert\\\" class=\\\"w-3 h-3\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" viewBox=\\\"0 0 24 24\\\"><path stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" stroke-width=\\\"2\\\" d=\\\"M13 10V3L4 14h7v7l9-11h-7z\\\"></path></svg> <svg id=\\\"icon-insert\\\" class=\\\"w-3 h-3 hidden\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" viewBox=\\\"0 0 24 24\\\"><path stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" stroke-width=\\\"2\\\" d=\\\"M12 4v16m8-8H4\\\"></path></svg> <span id=\\\"action-btn-text\\\">Convert Selection</span> </button> <button id=\\\"refresh-btn\\\" class=\\\"bg-white hover:bg-gray-50 text-gray-700 border border-gray-300 font-medium py-1.5 px-3 rounded shadow-sm transition-colors text-xs\\\" title=\\\"Refresh list\\\"> <svg class=\\\"w-3 h-3\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" viewBox=\\\"0 0 24 24\\\"><path stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" stroke-width=\\\"2\\\" d=\\\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\\\"></path></svg> </button> </div> <div class=\\\"bg-white border-b border-gray-200 flex select-none\\\"> <button id=\\\"tab-variables\\\" class=\\\"flex-1 py-2.5 text-center text-xs font-semibold border-b-2 border-blue-600 text-blue-600 transition-colors flex items-center justify-center gap-2\\\" title=\\\"Show Variables\\\"> Variables <span id=\\\"var-count\\\" class=\\\"bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded-full text-[10px]\\\">0</span> </button> <button id=\\\"tab-logic\\\" class=\\\"flex-1 py-2.5 text-center text-xs font-semibold border-b-2 border-transparent text-gray-500 hover:text-gray-700 transition-colors flex items-center justify-center gap-2\\\" title=\\\"Show Logic\\\"> Logic <span id=\\\"logic-count\\\" class=\\\"bg-gray-100 text-gray-600 px-1.5 py-0.5 rounded-full text-[10px]\\\">0</span> </button> <button id=\\\"tab-builder\\\" class=\\\"flex-1 py-2.5 text-center text-xs font-semibold border-b-2 border-transparent text-gray-500 hover:text-gray-700 transition-colors flex items-center justify-center gap-2\\\" title=\\\"Logic Builder\\\"> Builder </button> </div> <main class=\\\"flex-1 overflow-y-auto p-4 custom-scrollbar relative\\\"> <div id=\\\"section-variables\\\"> <div id=\\\"variable-list\\\" class=\\\"space-y-2\\\"> <div class=\\\"text-center py-8 text-gray-400 italic text-xs\\\"> No variables detected. </div> </div> </div> <div id=\\\"section-logic\\\" class=\\\"hidden\\\"> <div id=\\\"logic-list\\\" class=\\\"space-y-2\\\"> <div class=\\\"text-center py-8 text-gray-400 italic text-xs\\\"> No control logic detected. </div> </div> </div> <div id=\\\"section-builder\\\" class=\\\"hidden h-full flex flex-col\\\"> <div class=\\\"flex-1 flex gap-4 h-full overflow-hidden\\\"> <div class=\\\"w-3/5 flex flex-col overflow-y-auto pr-1\\\"> <h3 class=\\\"text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-2\\\">Statement</h3> <div id=\\\"builder-canvas\\\" class=\\\"flex-1 border-2 border-dashed border-gray-200 rounded p-2 min-h-[200px]\\\"> </div> </div> <div class=\\\"w-2/5 flex flex-col border-l border-gray-100 pl-2\\\"> <h3 class=\\\"text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-2\\\">Variables</h3> <div class=\\\"flex-1 overflow-y-auto custom-scrollbar\\\"> <div id=\\\"builder-vars\\\" class=\\\"space-y-1\\\"> </div> </div> </div> </div> </div> </main> <div class=\\\"bg-gray-900 text-gray-300 flex-shrink-0 border-t border-gray-700 transition-all duration-300 ease-in-out max-h-[40vh]\\\"> <div class=\\\"flex items-center justify-between px-3 py-1 bg-gray-800 border-b border-gray-700 cursor-pointer select-none\\\" id=\\\"console-header\\\"> <h3 class=\\\"font-mono text-xs font-semibold text-gray-400\\\">CONSOLE</h3> <span id=\\\"error-count\\\" class=\\\"text-xs bg-red-900 text-red-200 px-1.5 rounded hidden\\\">0</span> </div> <div id=\\\"console-output\\\" class=\\\"p-2 font-mono text-xs overflow-y-auto h-32 space-y-1\\\"> <div class=\\\"text-gray-500 italic\\\">Ready to scan.</div> </div> </div> <div id=\\\"sideload-msg\\\" class=\\\"hidden absolute inset-0 bg-white z-50 flex items-center justify-center p-8 text-center\\\"> <h2 class=\\\"text-xl text-gray-600\\\">Please sideload your add-in.</h2> </div> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_2___ + \"\\\"><\" + \"/script> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","autoRefreshInterval","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","_arrayLikeToArray","Array","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","currentTab","logicBuilder","LogicBuilder","_classCallCheck","variables","currentBlock","type","container","variableContainer","key","containerId","variableContainerId","getElementById","renderEmptyState","vars","renderVariableList","_this","innerHTML","forEach","el","createElement","className","innerText","draggable","addEventListener","dataTransfer","setData","effectAllowed","appendChild","_this2","onclick","startIf","startFor","startFilter","conditions","left","op","right","content","elseContent","hasElse","renderIfBuilder","iterable","renderForBuilder","variable","filter","customFilter","renderFilterBuilder","_this3","wrapper","header","resetBtn","cond","index","row","label","removeBtn","splice","inputsRow","leftIn","createDroppableInput","val","opSelect","opt","selected","onchange","target","rightIn","contentRow","contentIn","placeholder","oninput","elseRow","controls","addElifBtn","title","push","addElseBtn","disabled","_this4","iterInput","inLabel","iterableInput","classList","remove","add","_this5","varGroup","varInput","filterGroup","filterSelect","customInput","focus","initialValue","onChange","input","ondragover","preventDefault","ondragleave","ondrop","varName","getData","start","selectionStart","end","selectionEnd","text","newVal","substring","output","tag","concat","iter","list","startAutoRefresh","clearInterval","setInterval","tryCatch","scanDocument","switchTab","tabName","tabs","logic","builder","sections","values","badge","querySelector","s","activeTab","btnText","iconConvert","iconInsert","_handlePrimaryAction","_callee2","_context2","insertLogic","convertSelection","_scanDocument","_callee4","_context4","Word","run","_ref2","_callee3","context","body","_parseJinja","logicBlocks","errors","variableCounts","_context3","load","sync","parseJinja","renderVariables","renderLogic","renderConsole","updateVariables","_x6","_convertSelection","_callee6","_context6","_ref3","_callee5","selection","rawText","cleanName","newVar","_context5","getSelection","trim","toLowerCase","insertText","InsertLocation","_x7","_insertLogic","_callee8","jinjaCode","_context8","generateJinja","_ref4","_callee7","_context7","_x8","renameVariable","_x","_x2","_renameVariable","_callee0","oldName","newName","_context0","_ref5","_callee9","searchResults","item","match","_context9","search","matchWildcards","items","exec","_x9","Set","variableMap","Map","ifStack","forStack","validPattern","fullMatch","includes","message","snippet","set","get","lMatch","logicPattern","summary","startsWith","pop","unclosed","singleOpenRegex","singleCloseRegex","matchAll","isArray","_arrayWithoutHoles","from","_iterableToArray","toString","slice","constructor","name","_unsupportedIterableToArray","_nonIterableSpread","idx","regex","msg","errMatch","sort","activeElement","count","safeId","countSpan","meaningfulBlocks","block","icon","colorClass","textClass","consoleOutput","errorCountBadge","err","line","clickable","cursorClass","_x3","_navigateToError","navigateToError","_callee10","_context10","_ref6","_callee1","_context1","matchCase","select","_x0","_x5","_tryCatch","_callee11","callback","_t","_context11","console","error","Office","onReady","info","host","HostType","style","display","init","handlePrimaryAction","toggleEdit","id","view","edit","contains","saveRename","_ref","_callee","_context","getAttribute","_x4","URL"],"ignoreList":[],"sourceRoot":""}
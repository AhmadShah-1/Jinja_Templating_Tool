{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/logicbuilder.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\n * Logic Builder Module\n * Handles the UI and Logic generation for the Stanza Logic Builder tab.\n */\n\nexport class LogicBuilder {\n    constructor() {\n        this.variables = [];\n        this.currentBlock = { type: null }; // { type: 'if', conditions: [], else: false }\n        this.container = null;\n        this.variableContainer = null;\n    }\n\n    init(containerId, variableContainerId) {\n        this.container = document.getElementById(containerId);\n        this.variableContainer = document.getElementById(variableContainerId);\n        this.renderEmptyState();\n    }\n\n    updateVariables(vars) {\n        this.variables = vars;\n        this.renderVariableList();\n    }\n\n    renderVariableList() {\n        if (!this.variableContainer) return;\n        \n        this.variableContainer.innerHTML = \"\";\n        if (this.variables.length === 0) {\n            this.variableContainer.innerHTML = `<div class=\"text-gray-400 italic text-xs p-2\">No variables found</div>`;\n            return;\n        }\n\n        this.variables.forEach(v => {\n            const el = document.createElement(\"div\");\n            el.className = \"bg-white border border-gray-200 rounded px-2 py-1 text-xs cursor-grab hover:border-blue-400 mb-1 shadow-sm select-none\";\n            el.innerText = v;\n            el.draggable = true;\n            el.addEventListener(\"dragstart\", (e) => {\n                e.dataTransfer.setData(\"text/plain\", v);\n                e.dataTransfer.effectAllowed = \"copy\";\n            });\n            this.variableContainer.appendChild(el);\n        });\n    }\n\n    renderEmptyState() {\n        this.container.innerHTML = `\n            <div class=\"flex flex-col items-center justify-center h-full text-gray-500 space-y-4 mt-8\">\n                <p class=\"text-xs italic\">Select a block type to start</p>\n                <div class=\"flex flex-wrap gap-2 justify-center\">\n                    <button id=\"btn-start-if\" class=\"bg-blue-50 text-blue-600 border border-blue-200 px-3 py-1.5 rounded text-xs hover:bg-blue-100 font-medium\">If Statement</button>\n                    <button id=\"btn-start-for\" class=\"bg-green-50 text-green-600 border border-green-200 px-3 py-1.5 rounded text-xs hover:bg-green-100 font-medium\">For Loop</button>\n                    <button id=\"btn-start-filter\" class=\"bg-purple-50 text-purple-600 border border-purple-200 px-3 py-1.5 rounded text-xs hover:bg-purple-100 font-medium\">Filter</button>\n                </div>\n            </div>\n        `;\n\n        document.getElementById(\"btn-start-if\").onclick = () => this.startIf();\n        document.getElementById(\"btn-start-for\").onclick = () => this.startFor();\n        document.getElementById(\"btn-start-filter\").onclick = () => this.startFilter();\n    }\n\n    startIf() {\n        this.currentBlock = {\n            type: 'if',\n            conditions: [{ left: '', op: '==', right: '', content: '' }], // Initial IF\n            elseContent: '',\n            hasElse: false\n        };\n        this.renderIfBuilder();\n    }\n\n    startFor() {\n        this.currentBlock = {\n            type: 'for',\n            iterator: 'item',\n            iterable: '',\n            content: ''\n        };\n        this.renderForBuilder();\n    }\n\n    startFilter() {\n        this.currentBlock = {\n            type: 'filter',\n            variable: '',\n            filter: 'upper',\n            customFilter: ''\n        };\n        this.renderFilterBuilder();\n    }\n\n    renderIfBuilder() {\n        this.container.innerHTML = \"\";\n        const wrapper = document.createElement(\"div\");\n        wrapper.className = \"space-y-2\";\n\n        // Header / Reset\n        const header = document.createElement(\"div\");\n        header.className = \"flex justify-between items-center mb-4\";\n        header.innerHTML = `<span class=\"font-bold text-xs text-gray-700\">IF Statement</span>`;\n        const resetBtn = document.createElement(\"button\");\n        resetBtn.innerText = \"Reset\";\n        resetBtn.className = \"text-xs text-red-500 hover:underline\";\n        resetBtn.onclick = () => this.renderEmptyState();\n        header.appendChild(resetBtn);\n        wrapper.appendChild(header);\n\n        // Conditions (IF + ELIFs)\n        this.currentBlock.conditions.forEach((cond, index) => {\n            const row = document.createElement(\"div\");\n            row.className = \"bg-gray-50 p-2 rounded border border-gray-200 space-y-2 relative group\";\n            \n            const label = document.createElement(\"div\");\n            label.className = \"text-[10px] font-mono font-bold text-blue-600 uppercase\";\n            label.innerText = index === 0 ? \"IF\" : \"ELIF\";\n            \n            // Remove ELIF button\n            if (index > 0) {\n                const removeBtn = document.createElement(\"button\");\n                removeBtn.innerHTML = \"&times;\";\n                removeBtn.className = \"absolute top-1 right-2 text-gray-400 hover:text-red-500 text-lg leading-3\";\n                removeBtn.onclick = () => {\n                    this.currentBlock.conditions.splice(index, 1);\n                    this.renderIfBuilder();\n                };\n                row.appendChild(removeBtn);\n            }\n\n            const inputsRow = document.createElement(\"div\");\n            inputsRow.className = \"flex gap-1 items-center\";\n\n            // Left Input\n            const leftIn = this.createDroppableInput(cond.left, (val) => cond.left = val);\n            // Operator\n            const opSelect = document.createElement(\"select\");\n            opSelect.className = \"border border-gray-300 rounded text-xs py-1 px-0.5 bg-white\";\n            [\"==\", \"!=\", \">\", \">=\", \"<\", \"<=\", \"in\", \"not in\"].forEach(op => {\n                const opt = document.createElement(\"option\");\n                opt.value = op;\n                opt.innerText = op;\n                if (op === cond.op) opt.selected = true;\n                opSelect.appendChild(opt);\n            });\n            opSelect.onchange = (e) => cond.op = e.target.value;\n\n            // Right Input\n            const rightIn = this.createDroppableInput(cond.right, (val) => cond.right = val);\n\n            inputsRow.appendChild(leftIn);\n            inputsRow.appendChild(opSelect);\n            inputsRow.appendChild(rightIn);\n\n            // Action/Content Input\n            const contentRow = document.createElement(\"div\");\n            contentRow.className = \"mt-1 pt-1 border-t border-gray-200 border-dashed\";\n            const contentIn = document.createElement(\"input\");\n            contentIn.className = \"w-full border border-gray-300 rounded px-1.5 py-1 text-xs focus:ring-1 focus:ring-blue-500 outline-none transition-colors bg-white\";\n            contentIn.placeholder = \"Then output this text...\";\n            contentIn.value = cond.content || \"\";\n            contentIn.oninput = (e) => cond.content = e.target.value;\n            contentRow.appendChild(contentIn);\n\n            row.appendChild(label);\n            row.appendChild(inputsRow);\n            row.appendChild(contentRow);\n            wrapper.appendChild(row);\n        });\n\n        // ELSE\n        if (this.currentBlock.hasElse) {\n            const elseRow = document.createElement(\"div\");\n            elseRow.className = \"bg-gray-50 p-2 rounded border border-gray-200 relative space-y-2\";\n            elseRow.innerHTML = `<span class=\"text-[10px] font-mono font-bold text-blue-600 uppercase\">ELSE</span>`;\n            \n            const removeBtn = document.createElement(\"button\");\n            removeBtn.innerHTML = \"&times;\";\n            removeBtn.className = \"absolute top-1 right-2 text-gray-400 hover:text-red-500 text-lg leading-3\";\n            removeBtn.onclick = () => {\n                this.currentBlock.hasElse = false;\n                this.currentBlock.elseContent = '';\n                this.renderIfBuilder();\n            };\n            \n            const contentIn = document.createElement(\"input\");\n            contentIn.className = \"w-full border border-gray-300 rounded px-1.5 py-1 text-xs focus:ring-1 focus:ring-blue-500 outline-none transition-colors bg-white\";\n            contentIn.placeholder = \"Otherwise output this text...\";\n            contentIn.value = this.currentBlock.elseContent || \"\";\n            contentIn.oninput = (e) => this.currentBlock.elseContent = e.target.value;\n\n            elseRow.appendChild(removeBtn);\n            elseRow.appendChild(contentIn);\n            wrapper.appendChild(elseRow);\n        }\n\n        // Controls (+ / -)\n        const controls = document.createElement(\"div\");\n        controls.className = \"flex gap-2 mt-2\";\n\n        const addElifBtn = document.createElement(\"button\");\n        addElifBtn.className = \"flex-1 bg-blue-50 text-blue-600 border border-blue-200 rounded py-1 text-lg font-bold hover:bg-blue-100\";\n        addElifBtn.innerText = \"+\";\n        addElifBtn.title = \"Add ELIF\";\n        addElifBtn.onclick = () => {\n            this.currentBlock.conditions.push({ left: '', op: '==', right: '', content: '' });\n            this.renderIfBuilder();\n        };\n\n        const addElseBtn = document.createElement(\"button\");\n        addElseBtn.className = \"flex-1 bg-gray-100 text-gray-600 border border-gray-300 rounded py-1 text-lg font-bold hover:bg-gray-200 disabled:opacity-50\";\n        addElseBtn.innerText = \"-\";\n        addElseBtn.title = \"Add ELSE\";\n        addElseBtn.disabled = this.currentBlock.hasElse;\n        addElseBtn.onclick = () => {\n            this.currentBlock.hasElse = true;\n            this.renderIfBuilder();\n        };\n\n        controls.appendChild(addElifBtn);\n        controls.appendChild(addElseBtn);\n        wrapper.appendChild(controls);\n\n        this.container.appendChild(wrapper);\n    }\n\n    renderForBuilder() {\n        this.container.innerHTML = \"\";\n        const wrapper = document.createElement(\"div\");\n        wrapper.className = \"space-y-2\";\n\n        // Header / Reset\n        const header = document.createElement(\"div\");\n        header.className = \"flex justify-between items-center mb-4\";\n        header.innerHTML = `<span class=\"font-bold text-xs text-gray-700\">FOR Loop</span>`;\n        const resetBtn = document.createElement(\"button\");\n        resetBtn.innerText = \"Reset\";\n        resetBtn.className = \"text-xs text-red-500 hover:underline\";\n        resetBtn.onclick = () => this.renderEmptyState();\n        header.appendChild(resetBtn);\n        wrapper.appendChild(header);\n\n        const row = document.createElement(\"div\");\n        row.className = \"bg-gray-50 p-2 rounded border border-gray-200 space-y-2\";\n        \n        const label = document.createElement(\"div\");\n        label.className = \"text-[10px] font-mono font-bold text-green-600 uppercase\";\n        label.innerText = \"FOR\";\n        \n        const inputsRow = document.createElement(\"div\");\n        inputsRow.className = \"flex gap-1 items-center text-xs\";\n\n        // Iterator (e.g. 'item')\n        const iterInput = document.createElement(\"input\");\n        iterInput.className = \"w-1/3 border border-gray-300 rounded px-1 py-1\";\n        iterInput.placeholder = \"item\";\n        iterInput.value = this.currentBlock.iterator;\n        iterInput.oninput = (e) => this.currentBlock.iterator = e.target.value;\n\n        const inLabel = document.createElement(\"span\");\n        inLabel.innerText = \"in\";\n        inLabel.className = \"font-bold text-gray-500\";\n\n        // Iterable (e.g. 'items') - Droppable\n        const iterableInput = this.createDroppableInput(this.currentBlock.iterable, (val) => this.currentBlock.iterable = val);\n        iterableInput.classList.remove(\"w-full\");\n        iterableInput.classList.add(\"flex-1\");\n\n        inputsRow.appendChild(iterInput);\n        inputsRow.appendChild(inLabel);\n        inputsRow.appendChild(iterableInput);\n\n        // Content Input\n        const contentRow = document.createElement(\"div\");\n        contentRow.className = \"mt-1 pt-1 border-t border-gray-200 border-dashed\";\n        const contentIn = document.createElement(\"input\");\n        contentIn.className = \"w-full border border-gray-300 rounded px-1.5 py-1 text-xs focus:ring-1 focus:ring-blue-500 outline-none transition-colors bg-white\";\n        contentIn.placeholder = \"Repeat this text...\";\n        contentIn.value = this.currentBlock.content || \"\";\n        contentIn.oninput = (e) => this.currentBlock.content = e.target.value;\n        contentRow.appendChild(contentIn);\n\n        row.appendChild(label);\n        row.appendChild(inputsRow);\n        row.appendChild(contentRow);\n        wrapper.appendChild(row);\n        \n        this.container.appendChild(wrapper);\n    }\n\n    renderFilterBuilder() {\n        this.container.innerHTML = \"\";\n        const wrapper = document.createElement(\"div\");\n        wrapper.className = \"space-y-2\";\n\n        // Header / Reset\n        const header = document.createElement(\"div\");\n        header.className = \"flex justify-between items-center mb-4\";\n        header.innerHTML = `<span class=\"font-bold text-xs text-gray-700\">Filter Variable</span>`;\n        const resetBtn = document.createElement(\"button\");\n        resetBtn.innerText = \"Reset\";\n        resetBtn.className = \"text-xs text-red-500 hover:underline\";\n        resetBtn.onclick = () => this.renderEmptyState();\n        header.appendChild(resetBtn);\n        wrapper.appendChild(header);\n\n        const row = document.createElement(\"div\");\n        row.className = \"bg-gray-50 p-2 rounded border border-gray-200 space-y-3\";\n        \n        // Variable Input\n        const varGroup = document.createElement(\"div\");\n        varGroup.className = \"space-y-1\";\n        varGroup.innerHTML = `<label class=\"text-[10px] font-bold text-gray-500 uppercase block\">Variable</label>`;\n        const varInput = this.createDroppableInput(this.currentBlock.variable, (val) => this.currentBlock.variable = val);\n        varGroup.appendChild(varInput);\n        \n        // Filter Selector\n        const filterGroup = document.createElement(\"div\");\n        filterGroup.className = \"space-y-1\";\n        filterGroup.innerHTML = `<label class=\"text-[10px] font-bold text-gray-500 uppercase block\">Filter</label>`;\n        \n        const filterSelect = document.createElement(\"select\");\n        filterSelect.className = \"w-full border border-gray-300 rounded px-1.5 py-1 text-xs bg-white focus:ring-1 focus:ring-purple-500 outline-none\";\n        \n        const filters = [\n            \"upper\", \"lower\", \"title\", \"capitalize\", \"trim\", \n            \"length\", \"round\", \"abs\", \"first\", \"last\", \"safe\", \"custom\"\n        ];\n        \n        filters.forEach(f => {\n            const opt = document.createElement(\"option\");\n            opt.value = f;\n            opt.innerText = f;\n            if (f === this.currentBlock.filter) opt.selected = true;\n            filterSelect.appendChild(opt);\n        });\n\n        // Custom Filter Input\n        const customInput = document.createElement(\"input\");\n        customInput.className = \"w-full border border-gray-300 rounded px-1.5 py-1 text-xs bg-white focus:ring-1 focus:ring-purple-500 outline-none mt-1 hidden\";\n        customInput.placeholder = \"Enter custom filter name\";\n        customInput.value = this.currentBlock.customFilter || \"\";\n        if (this.currentBlock.filter === 'custom') customInput.classList.remove('hidden');\n\n        customInput.oninput = (e) => this.currentBlock.customFilter = e.target.value;\n\n        filterSelect.onchange = (e) => {\n             this.currentBlock.filter = e.target.value;\n             if (e.target.value === 'custom') {\n                 customInput.classList.remove('hidden');\n                 customInput.focus();\n             } else {\n                 customInput.classList.add('hidden');\n             }\n        };\n        \n        filterGroup.appendChild(filterSelect);\n        filterGroup.appendChild(customInput);\n\n        row.appendChild(varGroup);\n        row.appendChild(filterGroup);\n        wrapper.appendChild(row);\n        \n        this.container.appendChild(wrapper);\n    }\n\n    createDroppableInput(initialValue, onChange) {\n        const input = document.createElement(\"input\");\n        input.type = \"text\";\n        input.className = \"w-full border border-gray-300 rounded px-1.5 py-1 text-xs focus:ring-1 focus:ring-blue-500 outline-none transition-colors\";\n        input.value = initialValue || \"\";\n        input.placeholder = \"Value / Drag Var\";\n        \n        input.oninput = (e) => onChange(e.target.value);\n\n        // Drag Events\n        input.ondragover = (e) => {\n            e.preventDefault();\n            input.classList.add(\"border-blue-500\", \"bg-blue-50\");\n        };\n\n        input.ondragleave = () => {\n            input.classList.remove(\"border-blue-500\", \"bg-blue-50\");\n        };\n\n        input.ondrop = (e) => {\n            e.preventDefault();\n            input.classList.remove(\"border-blue-500\", \"bg-blue-50\");\n            const varName = e.dataTransfer.getData(\"text/plain\");\n            if (varName) {\n                // If input is empty, just set it. If has content, append?\n                // For logic building, usually replacing or appending to cursor is best.\n                // Simple MVP: Append\n                const start = input.selectionStart;\n                const end = input.selectionEnd;\n                const text = input.value;\n                const newVal = text.substring(0, start) + varName + text.substring(end);\n                input.value = newVal;\n                onChange(newVal);\n                input.focus();\n            }\n        };\n\n        return input;\n    }\n\n    generateJinja() {\n        if (!this.currentBlock.type) return \"\";\n\n        if (this.currentBlock.type === 'if') {\n            let output = \"\";\n            this.currentBlock.conditions.forEach((cond, index) => {\n                const tag = index === 0 ? \"if\" : \"elif\";\n                // Simple validation: if inputs are empty, use placeholders\n                const left = cond.left || \"var\";\n                const right = cond.right || \"value\";\n                const content = cond.content ? ` ${cond.content}` : \"\";\n                \n                // Construct: {% if left op right %} content\n                // No newlines as requested for inline flow\n                output += `{% ${tag} ${left} ${cond.op} ${right} %}${content}`;\n            });\n            \n            if (this.currentBlock.hasElse) {\n                const elseContent = this.currentBlock.elseContent ? ` ${this.currentBlock.elseContent}` : \"\";\n                output += `{% else %}${elseContent}`;\n            }\n            \n            output += `{% endif %}`;\n            return output;\n        }\n\n        if (this.currentBlock.type === 'for') {\n            const iter = this.currentBlock.iterator || \"item\";\n            const list = this.currentBlock.iterable || \"items\";\n            const content = this.currentBlock.content ? ` ${this.currentBlock.content}` : \"\";\n            // Inline For Loop\n            return `{% for ${iter} in ${list} %}${content}{% endfor %}`;\n        }\n\n        if (this.currentBlock.type === 'filter') {\n            const v = this.currentBlock.variable || \"var\";\n            let f = this.currentBlock.filter || \"upper\";\n            if (f === 'custom') {\n                f = this.currentBlock.customFilter || \"custom_filter\";\n            }\n            return `{{ ${v} | ${f} }}`;\n        }\n\n        return \"\";\n    }\n}\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global document, Office, Word, setInterval, clearInterval */\n\nimport { LogicBuilder } from \"./logicbuilder\";\n\nlet autoRefreshInterval;\nlet currentTab = 'variables';\nconst logicBuilder = new LogicBuilder();\n\n// Enhanced error handling and debugging\nfunction logError(message, error) {\n  console.error(`[Stanza Add-in] ${message}`, error);\n  const consoleOutput = document.getElementById(\"console-output\");\n  if (consoleOutput) {\n    const errorDiv = document.createElement(\"div\");\n    errorDiv.className = \"text-red-400\";\n    errorDiv.textContent = `ERROR: ${message}${error ? ' - ' + error.message : ''}`;\n    consoleOutput.appendChild(errorDiv);\n    consoleOutput.scrollTop = consoleOutput.scrollHeight;\n  }\n}\n\nfunction logInfo(message) {\n  console.log(`[Stanza Add-in] ${message}`);\n  const consoleOutput = document.getElementById(\"console-output\");\n  if (consoleOutput) {\n    const infoDiv = document.createElement(\"div\");\n    infoDiv.className = \"text-gray-300\";\n    infoDiv.textContent = message;\n    consoleOutput.appendChild(infoDiv);\n    consoleOutput.scrollTop = consoleOutput.scrollHeight;\n  }\n}\n\n// Check if Office.js is loaded\nif (typeof Office === 'undefined') {\n  logError(\"Office.js is not loaded. Make sure the add-in is properly sideloaded.\");\n  const sideloadMsg = document.getElementById(\"sideload-msg\");\n  if (sideloadMsg) {\n    sideloadMsg.classList.remove(\"hidden\");\n    sideloadMsg.innerHTML = `\n      <div>\n        <h2 class=\"text-xl text-gray-600 mb-4\">Please sideload your add-in.</h2>\n        <p class=\"text-sm text-gray-500 mb-2\">Office.js failed to load.</p>\n        <p class=\"text-xs text-gray-400\">Check the browser console (F12) for more details.</p>\n      </div>\n    `;\n  }\n} else {\n  logInfo(\"Office.js loaded, initializing...\");\n  \n  Office.onReady((info) => {\n    logInfo(`Office.onReady called. Host: ${info.host}, Platform: ${info.platform}`);\n    \n    if (info.host === Office.HostType.Word) {\n      logInfo(\"Word host detected, initializing add-in...\");\n      \n      try {\n        const sideloadMsg = document.getElementById(\"sideload-msg\");\n        if (sideloadMsg) {\n          sideloadMsg.style.display = \"none\";\n        }\n        \n        // Initialize Logic Builder\n        try {\n          logicBuilder.init(\"builder-canvas\", \"builder-vars\");\n          logInfo(\"Logic Builder initialized\");\n        } catch (error) {\n          logError(\"Failed to initialize Logic Builder\", error);\n        }\n\n        // Attach event listeners with error handling\n        try {\n          const actionBtn = document.getElementById(\"action-btn\");\n          const refreshBtn = document.getElementById(\"refresh-btn\");\n          const tabVariables = document.getElementById(\"tab-variables\");\n          const tabLogic = document.getElementById(\"tab-logic\");\n          const tabBuilder = document.getElementById(\"tab-builder\");\n          \n          if (actionBtn) actionBtn.onclick = () => handlePrimaryAction();\n          if (refreshBtn) refreshBtn.onclick = () => tryCatch(scanDocument);\n          if (tabVariables) tabVariables.onclick = () => switchTab('variables');\n          if (tabLogic) tabLogic.onclick = () => switchTab('logic');\n          if (tabBuilder) tabBuilder.onclick = () => switchTab('builder');\n          \n          logInfo(\"Event listeners attached\");\n        } catch (error) {\n          logError(\"Failed to attach event listeners\", error);\n        }\n        \n        // Initial scan\n        tryCatch(scanDocument);\n\n        // Start Auto-Refresh (Every 5 seconds)\n        startAutoRefresh();\n        \n        logInfo(\"Add-in initialized successfully\");\n      } catch (error) {\n        logError(\"Error during initialization\", error);\n      }\n    } else {\n      logError(`Unsupported host: ${info.host}. This add-in only works with Word.`);\n      const sideloadMsg = document.getElementById(\"sideload-msg\");\n      if (sideloadMsg) {\n        sideloadMsg.classList.remove(\"hidden\");\n        sideloadMsg.innerHTML = `\n          <div>\n            <h2 class=\"text-xl text-gray-600 mb-4\">Unsupported Host</h2>\n            <p class=\"text-sm text-gray-500\">This add-in only works with Microsoft Word.</p>\n            <p class=\"text-xs text-gray-400 mt-2\">Current host: ${info.host}</p>\n          </div>\n        `;\n      }\n    }\n  }).catch((error) => {\n    logError(\"Office.onReady failed\", error);\n    const sideloadMsg = document.getElementById(\"sideload-msg\");\n    if (sideloadMsg) {\n      sideloadMsg.classList.remove(\"hidden\");\n      sideloadMsg.innerHTML = `\n        <div>\n          <h2 class=\"text-xl text-red-600 mb-4\">Initialization Failed</h2>\n          <p class=\"text-sm text-gray-500 mb-2\">${error.message || 'Unknown error'}</p>\n          <p class=\"text-xs text-gray-400\">Check the browser console (F12) for more details.</p>\n        </div>\n      `;\n    }\n  });\n}\n\nfunction startAutoRefresh() {\n    if (autoRefreshInterval) clearInterval(autoRefreshInterval);\n    autoRefreshInterval = setInterval(() => {\n        tryCatch(scanDocument);\n    }, 5000);\n}\n\n/**\n * Tab Switching Logic\n */\nfunction switchTab(tabName) {\n    currentTab = tabName;\n    const tabs = {\n        variables: document.getElementById(\"tab-variables\"),\n        logic: document.getElementById(\"tab-logic\"),\n        builder: document.getElementById(\"tab-builder\")\n    };\n    const sections = {\n        variables: document.getElementById(\"section-variables\"),\n        logic: document.getElementById(\"section-logic\"),\n        builder: document.getElementById(\"section-builder\")\n    };\n\n    // Reset all\n    Object.values(tabs).forEach(t => {\n        t.classList.remove(\"border-blue-600\", \"text-blue-600\");\n        t.classList.add(\"border-transparent\", \"text-gray-500\");\n        const badge = t.querySelector(\"span\");\n        if (badge) {\n            badge.classList.remove(\"bg-blue-100\", \"text-blue-700\");\n            badge.classList.add(\"bg-gray-100\", \"text-gray-600\");\n        }\n    });\n    Object.values(sections).forEach(s => s.classList.add(\"hidden\"));\n\n    // Activate current\n    const activeTab = tabs[tabName];\n    activeTab.classList.remove(\"border-transparent\", \"text-gray-500\");\n    activeTab.classList.add(\"border-blue-600\", \"text-blue-600\");\n    const badge = activeTab.querySelector(\"span\");\n    if (badge) {\n        badge.classList.remove(\"bg-gray-100\", \"text-gray-600\");\n        badge.classList.add(\"bg-blue-100\", \"text-blue-700\");\n    }\n    sections[tabName].classList.remove(\"hidden\");\n\n    updatePrimaryButton();\n}\n\nfunction updatePrimaryButton() {\n    const btnText = document.getElementById(\"action-btn-text\");\n    const iconConvert = document.getElementById(\"icon-convert\");\n    const iconInsert = document.getElementById(\"icon-insert\");\n\n    if (currentTab === 'builder') {\n        btnText.innerText = \"Insert Logic\";\n        iconConvert.classList.add(\"hidden\");\n        iconInsert.classList.remove(\"hidden\");\n    } else {\n        btnText.innerText = \"Convert Selection\";\n        iconConvert.classList.remove(\"hidden\");\n        iconInsert.classList.add(\"hidden\");\n    }\n}\n\nasync function handlePrimaryAction() {\n    if (currentTab === 'builder') {\n        await tryCatch(insertLogic);\n    } else {\n        await tryCatch(convertSelection);\n    }\n}\n\n/**\n * Scans the document for Jinja2 variables, logic, and validation errors.\n */\nasync function scanDocument() {\n  await Word.run(async (context) => {\n    // get body text\n    const body = context.document.body;\n    body.load(\"text\");\n    await context.sync();\n\n    const text = body.text;\n    \n    // Parse variables, logic, and find errors\n    const { variables, logicBlocks, errors, variableCounts } = parseJinja(text);\n\n    // Update UI\n    renderVariables(variables, variableCounts);\n    renderLogic(logicBlocks);\n    renderConsole(errors);\n\n    // Update Logic Builder with found variables\n    logicBuilder.updateVariables(variables);\n  });\n}\n\n/**\n * Converts currently selected text into a Jinja2 variable.\n */\nasync function convertSelection() {\n  await Word.run(async (context) => {\n    const selection = context.document.getSelection();\n    selection.load(\"text\");\n    await context.sync();\n\n    const rawText = selection.text.trim();\n    if (!rawText) return; // No text selected\n\n    // Sanitize: \"Customer Name\" -> \"customer_name\"\n    const cleanName = rawText\n      .toLowerCase()\n      .replace(/[^a-z0-9]+/g, \"_\")\n      .replace(/_+/g, \"_\")\n      .replace(/^_|_$/g, \"\");\n\n    const newVar = `{{ ${cleanName} }}`;\n    \n    // Insert/Replace\n    selection.insertText(newVar, Word.InsertLocation.replace);\n    await context.sync();\n    \n    // Refresh the list\n    await scanDocument();\n  });\n}\n\n/**\n * Inserts the generated logic from the builder into the document\n */\nasync function insertLogic() {\n    const jinjaCode = logicBuilder.generateJinja();\n    if (!jinjaCode) return;\n\n    await Word.run(async (context) => {\n        const selection = context.document.getSelection();\n        selection.insertText(jinjaCode, Word.InsertLocation.replace);\n        await context.sync();\n    });\n    \n    await scanDocument();\n}\n\n\n/**\n * Renames a variable throughout the document\n */\nasync function renameVariable(oldName, newName) {\n  if (!newName || oldName === newName) return;\n\n  if (autoRefreshInterval) clearInterval(autoRefreshInterval);\n\n  await Word.run(async (context) => {\n      const body = context.document.body;\n      \n      // Use wildcards to find {{ ... }} blocks\n      const searchResults = body.search(\"\\\\{\\\\{*\\\\}\\\\}\", { matchWildcards: true });\n      context.load(searchResults, 'text');\n      await context.sync();\n      \n      for (let i = searchResults.items.length - 1; i >= 0; i--) {\n          const item = searchResults.items[i];\n          const text = item.text;\n          const match = /\\{\\{\\s*([a-zA-Z0-9_]+)\\s*\\}\\}/.exec(text);\n          if (match && match[1] === oldName) {\n              item.insertText(`{{ ${newName} }}`, Word.InsertLocation.replace);\n          }\n      }\n      await context.sync();\n  });\n\n  startAutoRefresh();\n  await scanDocument();\n}\n\n/**\n * Regex Logic\n */\nfunction parseJinja(text) {\n  const variables = new Set();\n  const errors = [];\n  const variableMap = new Map(); // Name -> count\n  const logicBlocks = [];\n  \n  // Stacks for validation\n  const ifStack = [];\n  const forStack = [];\n\n  // 1. Find Valid Variables: {{ variable_name }}\n  const validPattern = /\\{\\{\\s*([a-zA-Z0-9_]+)\\s*\\}\\}/g;\n  let match;\n  \n  while ((match = validPattern.exec(text)) !== null) {\n    const fullMatch = match[0];\n    const varName = match[1];\n    if (fullMatch.includes(\"  \")) {\n      errors.push({\n        type: \"warning\",\n        message: `Extra whitespace in '${fullMatch}'`,\n        index: match.index,\n        length: fullMatch.length,\n        snippet: fullMatch // Add snippet\n      });\n    }\n    variables.add(varName);\n    variableMap.set(varName, (variableMap.get(varName) || 0) + 1);\n  }\n\n  // 2. Find Control Logic: {% ... %}\n  const logicPattern = /\\{%\\s*(.+?)\\s*%\\}/g;\n  let lMatch;\n  \n  while ((lMatch = logicPattern.exec(text)) !== null) {\n      const content = lMatch[1].trim();\n      let type = \"unknown\";\n      let summary = content;\n      const fullMatch = lMatch[0];\n      const index = lMatch.index;\n\n      if (content.startsWith(\"if \")) {\n          type = \"if\";\n          summary = content.substring(3); \n          ifStack.push({ type: 'if', index: index, content: fullMatch });\n      } else if (content.startsWith(\"elif \")) {\n          type = \"elif\";\n          summary = content.substring(5);\n          if (ifStack.length === 0) {\n              errors.push({ type: \"error\", message: `Unexpected '{% elif ... %}' without 'if'`, index: index, length: fullMatch.length, snippet: fullMatch });\n          }\n      } else if (content.startsWith(\"else\")) {\n          type = \"else\";\n          summary = \"(fallback)\";\n          if (ifStack.length === 0 && forStack.length === 0) {\n              errors.push({ type: \"error\", message: `Unexpected '{% else %}'`, index: index, length: fullMatch.length, snippet: fullMatch });\n          }\n      } else if (content.startsWith(\"endif\")) {\n          type = \"endif\";\n          summary = \"\";\n          if (ifStack.length === 0) {\n              errors.push({ type: \"error\", message: `Unexpected '{% endif %}' without 'if'`, index: index, length: fullMatch.length, snippet: fullMatch });\n          } else {\n              ifStack.pop();\n          }\n      } else if (content.startsWith(\"for \")) {\n          type = \"for\";\n          summary = content.substring(4);\n          forStack.push({ type: 'for', index: index, content: fullMatch });\n      } else if (content.startsWith(\"endfor\")) {\n          type = \"endfor\";\n          summary = \"\";\n          if (forStack.length === 0) {\n              errors.push({ type: \"error\", message: `Unexpected '{% endfor %}' without 'for'`, index: index, length: fullMatch.length, snippet: fullMatch });\n          } else {\n              forStack.pop();\n          }\n      }\n\n      logicBlocks.push({\n          type,\n          content,\n          summary,\n          fullMatch: lMatch[0]\n      });\n  }\n\n  // Check for unclosed blocks at end of file\n  if (ifStack.length > 0) {\n      const unclosed = ifStack[ifStack.length - 1];\n      errors.push({ type: \"error\", message: `Unclosed 'if' statement`, index: unclosed.index, length: unclosed.content.length, snippet: unclosed.content });\n  }\n  if (forStack.length > 0) {\n      const unclosed = forStack[forStack.length - 1];\n      errors.push({ type: \"error\", message: `Unclosed 'for' loop`, index: unclosed.index, length: unclosed.content.length, snippet: unclosed.content });\n  }\n\n  // 3. Validation / Error Scanning (Variables)\n  const singleOpenRegex = /(?<!\\{)\\{\\s*([a-zA-Z0-9_]+)\\s*\\}\\}/g;\n  while ((match = singleOpenRegex.exec(text)) !== null) {\n      errors.push({ type: \"error\", message: `Malformed opening brace: '{ ${match[1]} }}'`, index: match.index, length: match[0].length, snippet: match[0] });\n  }\n\n  const singleCloseRegex = /\\{\\{\\s*([a-zA-Z0-9_]+)\\s*\\}(?!\\})/g;\n  while ((match = singleCloseRegex.exec(text)) !== null) {\n      errors.push({ type: \"error\", message: `Malformed closing brace: '{{ ${match[1]} }'`, index: match.index, length: match[0].length, snippet: match[0] });\n  }\n\n  const openBraces = [...text.matchAll(/\\{\\{/g)];\n  openBraces.forEach(m => {\n      const idx = m.index;\n      const slice = text.slice(idx, idx + 50);\n      if (!slice.includes(\"}}\")) {\n          if (!slice.match(/\\{\\{\\s*[a-zA-Z0-9_]+\\s*\\}\\}/)) {\n               if (slice.includes(\"\\n\") || slice.length < 50) { \n                   errors.push({ type: \"error\", message: `Unclosed variable`, index: idx, length: 2, snippet: \"{{\" });\n               }\n          }\n      }\n  });\n\n  const badPatterns = [\n      { regex: /\\{\\{\\s*\\]/g, msg: \"Syntax Error: '{{ ]'\" },       \n      { regex: /\\{\\[\\s*\\}\\}/g, msg: \"Syntax Error: '{[ }}'\" },    \n      { regex: /\\{\\[\\s*\\}/g, msg: \"Syntax Error: '{[ }'\" },       \n      { regex: /\\[\\[/g, msg: \"Double brackets '[[' detected (use '{{')\" },\n      { regex: /\\]\\]/g, msg: \"Double brackets ']]' detected (use '}}')\" },\n      { regex: /\\{\\{\\s*\\}\\}/g, msg: \"Empty variable '{{ }}'\" },\n      { regex: /(?<!\\{)\\{\\s*[a-zA-Z0-9_]+\\s*\\}(?!\\})/g, msg: \"Single braces used '{ var }' (use '{{ var }}')\" }\n  ];\n\n  badPatterns.forEach(p => {\n      let errMatch;\n      while ((errMatch = p.regex.exec(text)) !== null) {\n           errors.push({ type: \"error\", message: `${p.msg} found.`, index: errMatch.index, length: errMatch[0].length, snippet: errMatch[0] });\n      }\n  });\n\n  return { \n    variables: Array.from(variables).sort(),\n    variableCounts: variableMap,\n    logicBlocks,\n    errors \n  };\n}\n\n/**\n * UI Rendering\n */\nfunction renderVariables(variables, variableCounts) {\n  if (document.activeElement && document.activeElement.tagName === \"INPUT\") {\n      return;\n  }\n\n  const list = document.getElementById(\"variable-list\");\n  const countSpan = document.getElementById(\"var-count\");\n  \n  countSpan.innerText = variables.length;\n  list.innerHTML = \"\";\n\n  if (variables.length === 0) {\n    list.innerHTML = `<div class=\"text-center py-8 text-gray-400 italic text-xs\">No variables detected. Click Refresh to scan.</div>`;\n    return;\n  }\n\n  variables.forEach((v, index) => {\n    const count = variableCounts.get(v) || 0;\n    const safeId = index; \n    \n    const item = document.createElement(\"div\");\n    item.className = \"group flex flex-col bg-white p-2 rounded border border-gray-200 hover:border-blue-400 transition-all shadow-sm mb-2\";\n    \n    // Render View Mode\n    item.innerHTML = `\n      <div class=\"flex items-center justify-between w-full\" id=\"view-${safeId}\">\n        <div class=\"flex items-center gap-2 overflow-hidden\">\n            <div class=\"flex items-center gap-1 text-gray-500 text-xs min-w-[24px]\">\n                <span class=\"bg-gray-100 px-1.5 py-0.5 rounded-full font-mono\" title=\"Occurrences\">${count}</span>\n            </div>\n            <span class=\"text-blue-600 bg-blue-50 p-0.5 rounded text-[10px] font-mono\">{{</span>\n            <span class=\"font-medium text-gray-700 truncate cursor-pointer hover:text-blue-700\" title=\"Click to rename\" onclick=\"toggleEdit('${safeId}')\">${v}</span>\n            <span class=\"text-blue-600 bg-blue-50 p-0.5 rounded text-[10px] font-mono\">}}</span>\n        </div>\n        <div class=\"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity\">\n             <button class=\"text-gray-400 hover:text-blue-600 p-1\" title=\"Rename\" onclick=\"toggleEdit('${safeId}')\">\n                <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\"></path></svg>\n            </button>\n            <button class=\"text-gray-400 hover:text-blue-600 p-1\" title=\"Copy\" onclick=\"navigator.clipboard.writeText('{{ ${v} }}')\">\n                <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\"></path></svg>\n            </button>\n        </div>\n      </div>\n      \n      <div class=\"hidden w-full mt-2 flex items-center gap-2\" id=\"edit-${safeId}\">\n        <input type=\"text\" id=\"input-${safeId}\" value=\"${v}\" data-original=\"${v}\" class=\"flex-1 border border-blue-300 rounded px-2 py-1 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500\" />\n        <button class=\"bg-blue-600 text-white px-2 py-1 rounded text-xs hover:bg-blue-700\" onclick=\"saveRename('${safeId}')\">Save</button>\n        <button class=\"text-gray-500 hover:text-gray-700 px-1\" onclick=\"toggleEdit('${safeId}')\"></button>\n      </div>\n    `;\n    list.appendChild(item);\n  });\n}\n\nfunction renderLogic(logicBlocks) {\n    const list = document.getElementById(\"logic-list\");\n    const countSpan = document.getElementById(\"logic-count\");\n\n    const meaningfulBlocks = logicBlocks.filter(l => !l.type.startsWith('end') && !l.type.startsWith('elif') && !l.type.startsWith('else'));\n    countSpan.innerText = meaningfulBlocks.length;\n    list.innerHTML = \"\";\n\n    if (logicBlocks.length === 0) {\n        list.innerHTML = `<div class=\"text-center py-4 text-gray-400 italic text-xs\">No control logic detected.</div>`;\n        return;\n    }\n\n    logicBlocks.forEach(block => {\n        const item = document.createElement(\"div\");\n        let icon = \"\";\n        let colorClass = \"bg-gray-50 border-gray-200\";\n        let textClass = \"text-gray-600\";\n\n        if (block.type === 'if') {\n            icon = `<svg class=\"w-3 h-3 text-purple-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"></path></svg>`;\n            colorClass = \"bg-purple-50 border-purple-100\";\n            textClass = \"text-purple-800 font-medium\";\n        } else if (block.type === 'for') {\n            icon = `<svg class=\"w-3 h-3 text-green-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"></path></svg>`;\n            colorClass = \"bg-green-50 border-green-100\";\n            textClass = \"text-green-800 font-medium\";\n        } else if (block.type.startsWith('end')) {\n             colorClass = \"bg-gray-50 border-transparent opacity-60\";\n             textClass = \"text-gray-400 font-mono text-[10px]\";\n        }\n\n        item.className = `flex items-center gap-2 p-1.5 rounded border ${colorClass} text-xs`;\n        item.innerHTML = `\n            ${icon}\n            <span class=\"font-mono ${block.type.startsWith('end') ? 'pl-4' : ''} ${textClass}\">${block.content}</span>\n        `;\n        \n        list.appendChild(item);\n    });\n}\n\nfunction renderConsole(errors) {\n  const consoleOutput = document.getElementById(\"console-output\");\n  const errorCountBadge = document.getElementById(\"error-count\");\n  consoleOutput.innerHTML = \"\";\n  \n  if (errors.length > 0) {\n    errorCountBadge.innerText = errors.length;\n    errorCountBadge.classList.remove(\"hidden\");\n    \n    errors.forEach(err => {\n      const line = document.createElement(\"div\");\n      const clickable = err.snippet !== undefined; // Only clickable if we captured a snippet\n      const cursorClass = clickable ? \"cursor-pointer hover:bg-gray-800\" : \"\";\n      \n      if (err.type === 'error') {\n          line.className = `text-red-400 flex gap-2 items-start py-0.5 ${cursorClass}`;\n          line.innerHTML = `<span class=\"text-red-500 font-bold text-xs mt-0.5\"></span> <span>${err.message}</span>`;\n      } else {\n          line.className = `text-yellow-400 flex gap-2 items-start py-0.5 ${cursorClass}`;\n          line.innerHTML = `<span class=\"text-yellow-500 font-bold text-xs mt-0.5\"></span> <span>${err.message}</span>`;\n      }\n      \n      if (clickable) {\n          line.onclick = () => navigateToError(err.snippet);\n          line.title = \"Go to error location\";\n      }\n      \n      consoleOutput.appendChild(line);\n    });\n  } else {\n    errorCountBadge.classList.add(\"hidden\");\n    consoleOutput.innerHTML = `<div class=\"text-green-500 flex gap-2 items-center\"><svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 13l4 4L19 7\"></path></svg> No errors found.</div>`;\n  }\n}\n\nasync function navigateToError(snippet) {\n    await Word.run(async (context) => {\n        const body = context.document.body;\n        // Search for the snippet text\n        // We use a specific logic: Find the first occurrence? \n        // Since we can't easily map index to range, we search for the snippet.\n        // This might select the *first* error if there are duplicates, but it's a good start.\n        const searchResults = body.search(snippet, { matchCase: true });\n        context.load(searchResults, 'items');\n        await context.sync();\n        \n        if (searchResults.items.length > 0) {\n            // Select the first match found. \n            // Ideally we'd find the exact one based on context, but that's hard without unique IDs.\n            searchResults.items[0].select();\n            await context.sync();\n        }\n    });\n}\n\n// Helpers for Edit Mode\nwindow.toggleEdit = (id) => {\n    const view = document.getElementById(`view-${id}`);\n    const edit = document.getElementById(`edit-${id}`);\n    if (view && edit) {\n        const isEditing = edit.classList.contains('hidden');\n        if (isEditing) {\n            view.classList.add('hidden');\n            edit.classList.remove('hidden');\n            document.getElementById(`input-${id}`).focus();\n        } else {\n            view.classList.remove('hidden');\n            edit.classList.add('hidden');\n        }\n    }\n};\n\nwindow.saveRename = async (id) => {\n    const input = document.getElementById(`input-${id}`);\n    if (input) {\n        const oldName = input.getAttribute(\"data-original\");\n        const newName = input.value.trim();\n        \n        if (!newName.match(/^[a-zA-Z0-9_]+$/)) {\n            console.error(\"Invalid variable name\");\n            input.classList.add(\"border-red-500\");\n            return;\n        }\n        \n        toggleEdit(id);\n        await tryCatch(() => renameVariable(oldName, newName));\n    }\n};\n\n\n/** Default helper for invoking an action and handling errors. */\nasync function tryCatch(callback) {\n  try {\n      await callback();\n  } catch (error) {\n      console.error(error);\n    const consoleOutput = document.getElementById(\"console-output\");\n    const line = document.createElement(\"div\");\n    line.className = \"text-red-400 break-words\";\n    line.innerText = `System Error: ${error.message}`;\n    consoleOutput.appendChild(line);\n  }\n}\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"../../assets/PVEDI.png\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_2___ = new URL(\"./taskpane.js\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html lang=\\\"en\\\"> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Stanza Template Assistant</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <\" + \"script src=\\\"https://cdn.tailwindcss.com\\\"><\" + \"/script> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"bg-gray-50 h-screen flex flex-col font-sans text-sm text-gray-800 overflow-hidden\\\"> <header class=\\\"bg-white border-b border-gray-200 p-4 flex items-center shadow-sm z-10\\\"> <img width=\\\"32\\\" height=\\\"32\\\" src=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\" alt=\\\"Stanza\\\" class=\\\"mr-3\\\"/> <h1 class=\\\"font-bold text-lg text-gray-900 tracking-tight\\\">Stanza</h1> </header> <div class=\\\"bg-gray-100 p-3 border-b border-gray-200 flex gap-2\\\"> <button id=\\\"action-btn\\\" class=\\\"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium py-1.5 px-3 rounded shadow transition-colors flex items-center justify-center gap-1 text-xs\\\" title=\\\"Action\\\"> <svg id=\\\"icon-convert\\\" class=\\\"w-3 h-3\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" viewBox=\\\"0 0 24 24\\\"><path stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" stroke-width=\\\"2\\\" d=\\\"M13 10V3L4 14h7v7l9-11h-7z\\\"></path></svg> <svg id=\\\"icon-insert\\\" class=\\\"w-3 h-3 hidden\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" viewBox=\\\"0 0 24 24\\\"><path stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" stroke-width=\\\"2\\\" d=\\\"M12 4v16m8-8H4\\\"></path></svg> <span id=\\\"action-btn-text\\\">Convert Selection</span> </button> <button id=\\\"refresh-btn\\\" class=\\\"bg-white hover:bg-gray-50 text-gray-700 border border-gray-300 font-medium py-1.5 px-3 rounded shadow-sm transition-colors text-xs\\\" title=\\\"Refresh list\\\"> <svg class=\\\"w-3 h-3\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" viewBox=\\\"0 0 24 24\\\"><path stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" stroke-width=\\\"2\\\" d=\\\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\\\"></path></svg> </button> </div> <div class=\\\"bg-white border-b border-gray-200 flex select-none\\\"> <button id=\\\"tab-variables\\\" class=\\\"flex-1 py-2.5 text-center text-xs font-semibold border-b-2 border-blue-600 text-blue-600 transition-colors flex items-center justify-center gap-2\\\" title=\\\"Show Variables\\\"> Variables <span id=\\\"var-count\\\" class=\\\"bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded-full text-[10px]\\\">0</span> </button> <button id=\\\"tab-logic\\\" class=\\\"flex-1 py-2.5 text-center text-xs font-semibold border-b-2 border-transparent text-gray-500 hover:text-gray-700 transition-colors flex items-center justify-center gap-2\\\" title=\\\"Show Logic\\\"> Logic <span id=\\\"logic-count\\\" class=\\\"bg-gray-100 text-gray-600 px-1.5 py-0.5 rounded-full text-[10px]\\\">0</span> </button> <button id=\\\"tab-builder\\\" class=\\\"flex-1 py-2.5 text-center text-xs font-semibold border-b-2 border-transparent text-gray-500 hover:text-gray-700 transition-colors flex items-center justify-center gap-2\\\" title=\\\"Logic Builder\\\"> Builder </button> </div> <main class=\\\"flex-1 overflow-y-auto p-4 custom-scrollbar relative\\\"> <div id=\\\"section-variables\\\"> <div id=\\\"variable-list\\\" class=\\\"space-y-2\\\"> <div class=\\\"text-center py-8 text-gray-400 italic text-xs\\\"> No variables detected. </div> </div> </div> <div id=\\\"section-logic\\\" class=\\\"hidden\\\"> <div id=\\\"logic-list\\\" class=\\\"space-y-2\\\"> <div class=\\\"text-center py-8 text-gray-400 italic text-xs\\\"> No control logic detected. </div> </div> </div> <div id=\\\"section-builder\\\" class=\\\"hidden h-full flex flex-col\\\"> <div class=\\\"flex-1 flex gap-4 h-full overflow-hidden\\\"> <div class=\\\"w-3/5 flex flex-col overflow-y-auto pr-1\\\"> <h3 class=\\\"text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-2\\\">Statement</h3> <div id=\\\"builder-canvas\\\" class=\\\"flex-1 border-2 border-dashed border-gray-200 rounded p-2 min-h-[200px]\\\"> </div> </div> <div class=\\\"w-2/5 flex flex-col border-l border-gray-100 pl-2\\\"> <h3 class=\\\"text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-2\\\">Variables</h3> <div class=\\\"flex-1 overflow-y-auto custom-scrollbar\\\"> <div id=\\\"builder-vars\\\" class=\\\"space-y-1\\\"> </div> </div> </div> </div> </div> </main> <div class=\\\"bg-gray-900 text-gray-300 flex-shrink-0 border-t border-gray-700 transition-all duration-300 ease-in-out max-h-[40vh]\\\"> <div class=\\\"flex items-center justify-between px-3 py-1 bg-gray-800 border-b border-gray-700 cursor-pointer select-none\\\" id=\\\"console-header\\\"> <h3 class=\\\"font-mono text-xs font-semibold text-gray-400\\\">CONSOLE</h3> <span id=\\\"error-count\\\" class=\\\"text-xs bg-red-900 text-red-200 px-1.5 rounded hidden\\\">0</span> </div> <div id=\\\"console-output\\\" class=\\\"p-2 font-mono text-xs overflow-y-auto h-32 space-y-1\\\"> <div class=\\\"text-gray-500 italic\\\">Ready to scan.</div> </div> </div> <div id=\\\"sideload-msg\\\" class=\\\"absolute inset-0 bg-white z-50 flex items-center justify-center p-8 text-center\\\"> <div> <h2 class=\\\"text-xl text-gray-600 mb-4\\\">Loading...</h2> <p class=\\\"text-sm text-gray-500\\\">Initializing Office Add-in...</p> </div> </div> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_2___ + \"\\\"><\" + \"/script> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","autoRefreshInterval","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","_arrayLikeToArray","Array","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","currentTab","logicBuilder","LogicBuilder","_classCallCheck","variables","currentBlock","type","container","variableContainer","key","containerId","variableContainerId","getElementById","renderEmptyState","vars","renderVariableList","_this","innerHTML","forEach","el","createElement","className","innerText","draggable","addEventListener","dataTransfer","setData","effectAllowed","appendChild","_this2","onclick","startIf","startFor","startFilter","conditions","left","op","right","content","elseContent","hasElse","renderIfBuilder","iterable","renderForBuilder","variable","filter","customFilter","renderFilterBuilder","_this3","wrapper","header","resetBtn","cond","index","row","label","removeBtn","splice","inputsRow","leftIn","createDroppableInput","val","opSelect","opt","selected","onchange","target","rightIn","contentRow","contentIn","placeholder","oninput","elseRow","controls","addElifBtn","title","push","addElseBtn","disabled","_this4","iterInput","inLabel","iterableInput","classList","remove","add","_this5","varGroup","varInput","filterGroup","filterSelect","customInput","focus","initialValue","onChange","input","ondragover","preventDefault","ondragleave","ondrop","varName","getData","start","selectionStart","end","selectionEnd","text","newVal","substring","output","tag","concat","iter","list","logError","message","error","console","consoleOutput","errorDiv","textContent","scrollTop","scrollHeight","logInfo","log","infoDiv","Office","sideloadMsg","onReady","info","host","platform","HostType","Word","style","display","init","actionBtn","refreshBtn","tabVariables","tabLogic","tabBuilder","_handlePrimaryAction","handlePrimaryAction","tryCatch","scanDocument","switchTab","startAutoRefresh","catch","clearInterval","setInterval","tabName","tabs","logic","builder","sections","values","badge","querySelector","s","activeTab","btnText","iconConvert","iconInsert","_callee2","_context2","insertLogic","convertSelection","_scanDocument","_callee4","_context4","run","_ref2","_callee3","context","body","_parseJinja","logicBlocks","errors","variableCounts","_context3","load","sync","parseJinja","renderVariables","renderLogic","renderConsole","updateVariables","_x6","_convertSelection","_callee6","_context6","_ref3","_callee5","selection","rawText","cleanName","newVar","_context5","getSelection","trim","toLowerCase","insertText","InsertLocation","_x7","_insertLogic","_callee8","jinjaCode","_context8","generateJinja","_ref4","_callee7","_context7","_x8","renameVariable","_x","_x2","_renameVariable","_callee0","oldName","newName","_context0","_ref5","_callee9","searchResults","item","match","_context9","search","matchWildcards","items","exec","_x9","Set","variableMap","Map","ifStack","forStack","validPattern","fullMatch","includes","snippet","set","get","lMatch","logicPattern","summary","startsWith","pop","unclosed","singleOpenRegex","singleCloseRegex","matchAll","isArray","_arrayWithoutHoles","from","_iterableToArray","toString","slice","constructor","name","_unsupportedIterableToArray","_nonIterableSpread","idx","regex","msg","errMatch","sort","activeElement","count","safeId","countSpan","meaningfulBlocks","block","icon","colorClass","textClass","errorCountBadge","err","line","clickable","cursorClass","_x3","_navigateToError","navigateToError","_callee10","_context10","_ref6","_callee1","_context1","matchCase","select","_x0","_x5","_tryCatch","_callee11","callback","_t","_context11","toggleEdit","id","view","edit","contains","saveRename","_ref","_callee","_context","getAttribute","_x4","URL"],"ignoreList":[],"sourceRoot":""}